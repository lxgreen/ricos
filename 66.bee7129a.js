(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{300:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(1),i=(o=r)&&o.__esModule?o:{default:o};var a={readOnly:i.default.bool,key:i.default.string,className:i.default.string,component:i.default.oneOfType([i.default.element,i.default.func]),forceComponent:i.default.bool,disableEvents:i.default.bool,disableUpdatedFlag:i.default.bool,colSpan:i.default.number,rowSpan:i.default.number,width:i.default.oneOfType([i.default.number,i.default.string]),overflow:i.default.oneOf(["wrap","nowrap","clip"]),dataEditor:i.default.func,valueViewer:i.default.func};t.default=a},387:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(0),a=s(i),u=s(n(1)),l=s(n(300));function s(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(){return d(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.cell,n=e.row,r=e.col,i=e.attributesRenderer,u=e.className,l=e.style,s=e.onMouseDown,d=e.onMouseOver,c=e.onDoubleClick,f=e.onContextMenu,p=t.colSpan,h=t.rowSpan,v=i?i(t,n,r):{};return a.default.createElement("td",o({className:u,onMouseDown:s,onMouseOver:d,onDoubleClick:c,onTouchEnd:c,onContextMenu:f,colSpan:p,rowSpan:h,style:l},v),this.props.children)}}]),t}(i.PureComponent);t.default=f,f.propTypes={row:u.default.number.isRequired,col:u.default.number.isRequired,cell:u.default.shape(l.default).isRequired,selected:u.default.bool,editing:u.default.bool,updated:u.default.bool,attributesRenderer:u.default.func,onMouseDown:u.default.func.isRequired,onMouseOver:u.default.func.isRequired,onDoubleClick:u.default.func.isRequired,onContextMenu:u.default.func.isRequired,className:u.default.string,style:u.default.object},f.defaultProps={selected:!1,editing:!1,updated:!1,attributesRenderer:function(){}}},559:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),i=u(r),a=u(n(1));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){function t(){return l(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){return i.default.createElement("table",{className:this.props.className},i.default.createElement("tbody",null,this.props.children))}}]),t}(r.PureComponent);d.propTypes={className:a.default.string,data:a.default.array.isRequired},t.default=d},560:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),i=l(r),a=l(n(1)),u=l(n(300));function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=function(e){function t(){return s(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){return i.default.createElement("tr",null,this.props.children)}}]),t}(r.PureComponent);c.propTypes={row:a.default.number.isRequired,cells:a.default.arrayOf(a.default.shape(u.default)).isRequired},t.default=c},561:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TAB_KEY=9,t.ENTER_KEY=13,t.ESCAPE_KEY=27,t.LEFT_KEY=37,t.UP_KEY=38,t.RIGHT_KEY=39,t.DOWN_KEY=40,t.DELETE_KEY=46,t.BACKSPACE_KEY=8},562:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),i=l(r),a=l(n(1)),u=l(n(300));function l(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=n.handleChange.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){this._input.focus()}},{key:"handleChange",value:function(e){this.props.onChange(e.target.value)}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,o=t.onKeyDown;return i.default.createElement("input",{ref:function(t){e._input=t},className:"data-editor",value:n,onChange:this.handleChange,onKeyDown:o})}}]),t}(r.PureComponent);t.default=s,s.propTypes={value:a.default.node.isRequired,row:a.default.number.isRequired,col:a.default.number.isRequired,cell:a.default.shape(u.default),onChange:a.default.func.isRequired,onCommit:a.default.func.isRequired,onRevert:a.default.func.isRequired,onKeyDown:a.default.func.isRequired}},563:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),i=l(r),a=l(n(1)),u=l(n(300));function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=function(e){function t(){return s(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this.props.value;return i.default.createElement("span",{className:"value-viewer"},e)}}]),t}(r.PureComponent);t.default=c,c.propTypes={row:a.default.number.isRequired,col:a.default.number.isRequired,cell:a.default.shape(u.default),value:a.default.node.isRequired}},769:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderData=t.renderValue=t.ValueViewer=t.DataEditor=t.Cell=t.Row=t.Sheet=void 0;var o=d(n(770)),r=d(n(559)),i=d(n(560)),a=d(n(387)),u=d(n(562)),l=d(n(563)),s=n(772);function d(e){return e&&e.__esModule?e:{default:e}}t.default=o.default,t.Sheet=r.default,t.Row=i.default,t.Cell=a.default,t.DataEditor=u.default,t.ValueViewer=l.default,t.renderValue=s.renderValue,t.renderData=s.renderData},770:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(0),a=v(i),u=v(n(1)),l=v(n(559)),s=v(n(560)),d=v(n(387)),c=v(n(771)),f=v(n(562)),p=v(n(563)),h=n(561);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){return 0===Object.keys(e).length},b=function(e,t){for(var n=[],o=t-e>0,r=e;o?r<=t:r>=t;o?r++:r--)o?n.push(r):n.unshift(r);return n},m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseDown=n.onMouseDown.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n.onMouseOver=n.onMouseOver.bind(n),n.onDoubleClick=n.onDoubleClick.bind(n),n.onContextMenu=n.onContextMenu.bind(n),n.handleNavigate=n.handleNavigate.bind(n),n.handleKey=n.handleKey.bind(n).bind(n),n.handleCut=n.handleCut.bind(n),n.handleCopy=n.handleCopy.bind(n),n.handlePaste=n.handlePaste.bind(n),n.pageClick=n.pageClick.bind(n),n.onChange=n.onChange.bind(n),n.onRevert=n.onRevert.bind(n),n.isSelected=n.isSelected.bind(n),n.isEditing=n.isEditing.bind(n),n.handleComponentKey=n.handleComponentKey.bind(n),n.handleKeyboardCellMovement=n.handleKeyboardCellMovement.bind(n),n.defaultState={start:{},end:{},selecting:!1,forceEdit:!1,editing:{}},n.state=n.defaultState,n.removeAllListeners=n.removeAllListeners.bind(n),n.handleIEClipboardEvents=n.handleIEClipboardEvents.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"removeAllListeners",value:function(){document.removeEventListener("mousedown",this.pageClick),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("cut",this.handleCut),document.removeEventListener("copy",this.handleCopy),document.removeEventListener("paste",this.handlePaste),document.removeEventListener("keydown",this.handleIEClipboardEvents)}},{key:"componentDidMount",value:function(){this.dgDom&&this.dgDom.addEventListener("keydown",this.handleComponentKey)}},{key:"componentWillUnmount",value:function(){this.dgDom&&this.dgDom.removeEventListener("keydown",this.handleComponentKey),this.removeAllListeners()}},{key:"isSelectionControlled",value:function(){return"selected"in this.props}},{key:"getState",value:function(){var e=this.state;if(this.isSelectionControlled()){var t=this.props.selected||{},n=t.start,r=t.end;n=n||this.defaultState.start,r=r||this.defaultState.end,e=o({},e,{start:n,end:r})}return e}},{key:"_setState",value:function(e){if(this.isSelectionControlled()&&("start"in e||"end"in e)){var t=e.start,n=e.end,o=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(e,["start","end"]),r=this.props,i=r.selected,a=r.onSelect;i=i||{},t||(t="start"in i?i.start:this.defaultState.start),n||(n="end"in i?i.end:this.defaultState.end),a&&a({start:t,end:n}),this.setState(o)}else this.setState(e)}},{key:"pageClick",value:function(e){this.props.disablePageClick||(this.dgDom.contains(e.target)||(this.setState(this.defaultState),this.removeAllListeners()))}},{key:"handleCut",value:function(e){if(y(this.state.editing)){e.preventDefault(),this.handleCopy(e);var t=this.getState(),n=t.start,o=t.end;this.clearSelectedCells(n,o)}}},{key:"handleIEClipboardEvents",value:function(e){e.ctrlKey&&(67===e.keyCode?this.handleCopy(e):88===e.keyCode?this.handleCut(e):86!==e.keyCode&&86!==e.which||this.handlePaste(e))}},{key:"handleCopy",value:function(e){if(y(this.state.editing)){e.preventDefault();var t=this.getState(),n=t.start,o=t.end,r=this.getSelectedCells(this.props.data,n,o);this.setState({copiedCells:r})}}},{key:"handlePaste",value:function(e){if(y(this.state.editing)){var t=this.getState(),n=t.start,o=t.end,r=t.copiedCells,i=this.props.onPaste;n={i:Math.min(n.i,o.i),j:Math.min(n.j,o.j)},o={i:Math.max(n.i,o.i),j:Math.max(n.j,o.j)},i&&i(r,n,o)}}},{key:"handleKeyboardCellMovement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getState(),o=n.start,r=n.editing,i=this.props.data,a=r&&!y(r),u=i[o.i]&&i[o.i][o.j];if(a&&!t)return!1;var l=u&&u.component,s=e.which||e.keyCode,d=s===h.TAB_KEY;!d&&l&&a?e.preventDefault():d?this.handleNavigate(e,{i:0,j:e.shiftKey?-1:1},!0):s===h.RIGHT_KEY?this.handleNavigate(e,{i:0,j:1}):s===h.LEFT_KEY?this.handleNavigate(e,{i:0,j:-1}):s===h.UP_KEY?this.handleNavigate(e,{i:-1,j:0}):s===h.DOWN_KEY?this.handleNavigate(e,{i:1,j:0}):t&&s===h.ENTER_KEY&&this.handleNavigate(e,{i:e.shiftKey?-1:1,j:0})}},{key:"handleKey",value:function(e){if(!e.isPropagationStopped||!e.isPropagationStopped()){var t=e.which||e.keyCode,n=this.getState(),o=n.start,r=n.end,i=n.editing,a=i&&!y(i),u=!o||y(o),l=e.ctrlKey||e.metaKey,s=t===h.DELETE_KEY||t===h.BACKSPACE_KEY,d=t===h.ENTER_KEY,c=t>=48&&t<=57,f=t>=65&&t<=90,p=t>=160&&t<=255,v=t>=96&&t<=105,b=!u&&this.props.data[o.i][o.j],m=[187,189,190,107,109,110].indexOf(t)>-1;if(u||l)return!0;a||(this.handleKeyboardCellMovement(e),s?(e.preventDefault(),this.clearSelectedCells(o,r)):b&&!b.readOnly&&(d?(this._setState({editing:o,forceEdit:!0}),e.preventDefault()):(c||v||f||p||m)&&this._setState({editing:o,forceEdit:!1})))}}},{key:"getSelectedCells",value:function(e,t,n){var o=this,r=[];return b(t.i,n.i).map((function(i){b(t.j,n.j).map((function(t){e[i]&&e[i][t]&&r.push({i:i,j:t,content:o.props.getCellContent(i,t)})}))})),r}},{key:"clearSelectedCells",value:function(e,t){var n=this.props,o=n.data,r=n.onClear,i=this.getSelectedCells(o,e,t);r&&r(i)}},{key:"updateLocationSingleCell",value:function(e){this._setState({start:e,end:e,editing:{}})}},{key:"updateLocationMultipleCells",value:function(e){var t=this.getState(),n=t.start,o=t.end,r=this.props.data,i={i:n.i,j:n.j},a={i:o.i+e.i,j:Math.min(r[0].length-1,Math.max(0,o.j+e.j))};this._setState({start:i,end:a,editing:{}})}},{key:"searchForNextSelectablePos",value:function(e,t,n,o,r){for(var i=function(e){return{i:e.i+o.i,j:e.j+o.j}},a=function(e){var n=e.i,o=e.j;return t[n]&&void 0!==t[n][o]},u=i(n);a(u)&&!e(t[u.i][u.j],u.i,u.j);)u=i(u);if(!a(u)){if(!r)return null;u=o.j<0?{i:u.i-1,j:t[0].length-1}:function(e){return{i:e.i+1,j:0}}(u)}return a(u)&&!e(t[u.i][u.j],u.i,u.j)?this.searchForNextSelectablePos(e,t,u,o,r):a(u)?u:null}},{key:"handleNavigate",value:function(e,t,n){if(t&&(t.i||t.j)){var o=this.props.data,r=this.getState().start,i=e.shiftKey&&!n,a=this.props.isCellNavigable?this.props.isCellNavigable:function(){return!0};if(i)this.updateLocationMultipleCells(t);else{var u=this.searchForNextSelectablePos(a,o,r,t,n);u&&this.updateLocationSingleCell(u)}e.preventDefault()}}},{key:"handleComponentKey",value:function(e){var t=this,n=e.which||e.keyCode;if([h.ENTER_KEY,h.ESCAPE_KEY,h.TAB_KEY].includes(n)){var o=this.state.editing,r=this.props.data;if(!y(o)){var i=r[o.i][o.j],a=e.shiftKey?-1:1;if(i&&i.component&&!i.forceComponent){e.preventDefault();var u=this.onRevert;n===h.ENTER_KEY?u=function(){return t.handleNavigate(e,{i:a,j:0})}:n===h.TAB_KEY&&(u=function(){return t.handleNavigate(e,{i:0,j:a},!0)}),setTimeout((function(){u(),t.dgDom&&t.dgDom.focus()}),1)}}}}},{key:"onContextMenu",value:function(e,t,n){var o=this.props.data[t][n];this.props.onContextMenu&&this.props.onContextMenu(e,o,t,n)}},{key:"onDoubleClick",value:function(e,t){this.props.data[e][t].readOnly||this._setState({editing:{i:e,j:t},forceEdit:!0})}},{key:"onMouseDown",value:function(e,t,n){var o=!y(this.state.editing)&&this.state.editing.i===e&&this.state.editing.j===t,r=y(this.state.editing)||this.state.editing.i!==e||this.state.editing.j!==t?{}:this.state.editing,i=this.getState().start;this._setState({selecting:!o,start:n.shiftKey?i:{i:e,j:t},end:{i:e,j:t},editing:r,forceEdit:!!o});var a=window.navigator.userAgent;/MSIE|Trident/.test(a)&&document.addEventListener("keydown",this.handleIEClipboardEvents),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousedown",this.pageClick),document.addEventListener("cut",this.handleCut),document.addEventListener("copy",this.handleCopy),document.addEventListener("paste",this.handlePaste)}},{key:"onMouseOver",value:function(e,t){this.state.selecting&&y(this.state.editing)&&this._setState({end:{i:e,j:t}})}},{key:"onMouseUp",value:function(){this._setState({selecting:!1}),document.removeEventListener("mouseup",this.onMouseUp)}},{key:"onChange",value:function(e,t,n){var o=this.props,r=o.onChange,i=o.onCellsChanged,a=o.data;i?i([{cell:a[e][t],row:e,col:t,value:n}]):r&&r(a[e][t],e,t,n),this.onRevert()}},{key:"onRevert",value:function(){this._setState({editing:{}}),this.dgDom&&this.dgDom.focus()}},{key:"componentDidUpdate",value:function(e,t){var n=this.state,o=n.start,r=n.end,i=t.end;y(r)||r.i===i.i&&r.j===i.j||this.isSelectionControlled()||this.props.onSelect&&this.props.onSelect({start:o,end:r})}},{key:"isSelected",value:function(e,t){var n=this.getState(),o=n.start,r=n.end,i=t>=o.j&&t<=r.j,a=t<=o.j&&t>=r.j,u=e>=o.i&&e<=r.i,l=e<=o.i&&e>=r.i;return i&&u||a&&u||a&&l||i&&l}},{key:"isEditing",value:function(e,t){return this.state.editing.i===e&&this.state.editing.j===t}},{key:"render",value:function(){var e=this,t=this.props,n=t.sheetRenderer,r=t.rowRenderer,i=t.cellRenderer,u=t.dataRenderer,l=t.valueRenderer,s=t.dataEditor,d=t.valueViewer,f=t.attributesRenderer,p=t.className,h=t.overflow,v=t.data,y=t.keyFn,b=t.getCellContent,m=t.setCellContent,C=this.state.forceEdit;return a.default.createElement("span",{ref:function(t){e.dgDom=t},tabIndex:"0",className:"data-grid-container",onKeyDown:this.handleKey},a.default.createElement(n,{data:v,className:["data-grid",p,h].filter((function(e){return e})).join(" ")},v.map((function(t,n){return a.default.createElement(r,{key:y?y(n):n,row:n,cells:t},t.map((function(t,r){var p=e.isEditing(n,r);return a.default.createElement(c.default,o({key:t.key?t.key:n+"-"+r,row:n,col:r,cell:t,forceEdit:!1,onMouseDown:e.onMouseDown,onMouseOver:e.onMouseOver,onDoubleClick:e.onDoubleClick,onContextMenu:e.onContextMenu,onChange:e.onChange,onRevert:e.onRevert,onNavigate:e.handleKeyboardCellMovement,onKey:e.handleKey,selected:e.isSelected(n,r),editing:p,attributesRenderer:f,cellRenderer:i,valueRenderer:l,dataRenderer:u,valueViewer:d,dataEditor:s,getCellContent:b,setCellContent:m},p?{forceEdit:C}:{}))})))}))))}}]),t}(i.PureComponent);t.default=m,m.propTypes={data:u.default.array.isRequired,className:u.default.string,disablePageClick:u.default.bool,overflow:u.default.oneOf(["wrap","nowrap","clip"]),onChange:u.default.func,onCellsChanged:u.default.func,onContextMenu:u.default.func,onSelect:u.default.func,isCellNavigable:u.default.func,selected:u.default.shape({start:u.default.shape({i:u.default.number,j:u.default.number}),end:u.default.shape({i:u.default.number,j:u.default.number})}),valueRenderer:u.default.func.isRequired,dataRenderer:u.default.func,sheetRenderer:u.default.func.isRequired,rowRenderer:u.default.func.isRequired,cellRenderer:u.default.func.isRequired,valueViewer:u.default.func,dataEditor:u.default.func,parsePaste:u.default.func,attributesRenderer:u.default.func,keyFn:u.default.func,handleCopy:u.default.func,onClear:u.default.func},m.defaultProps={sheetRenderer:l.default,rowRenderer:s.default,cellRenderer:d.default,valueViewer:p.default,dataEditor:f.default}},771:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),i=d(r),a=d(n(1)),u=n(561),l=d(n(387)),s=d(n(300));function d(e){return e&&e.__esModule?e:{default:e}}function c(e){var t="number"==typeof e.width?e.width+"px":e.width;return t?{width:t}:null}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleCommit=n.handleCommit.bind(n),n.handleRevert=n.handleRevert.bind(n),n.handleKey=n.handleKey.bind(n),n.handleMouseDown=n.handleMouseDown.bind(n),n.handleMouseOver=n.handleMouseOver.bind(n),n.handleContextMenu=n.handleContextMenu.bind(n),n.handleDoubleClick=n.handleDoubleClick.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidUpdate",value:function(e){if(!0===this.props.editing&&!1===e.editing){var t=this.props,n=t.row,o=t.col,r=t.getCellContent;this.initialContent=r&&r(n,o)}}},{key:"handleCommit",value:function(e){var t=this.props.onNavigate;this.handleRevert(),e&&(e.preventDefault(),t(e,!0))}},{key:"handleRevert",value:function(){this.props.onRevert()}},{key:"handleMouseDown",value:function(e){var t=this.props,n=t.row,o=t.col,r=t.onMouseDown;t.cell.disableEvents||r(n,o,e)}},{key:"handleMouseOver",value:function(e){var t=this.props,n=t.row,o=t.col,r=t.onMouseOver;t.cell.disableEvents||r(n,o)}},{key:"handleDoubleClick",value:function(e){var t=this.props,n=t.row,o=t.col,r=t.onDoubleClick;t.cell.disableEvents||r(n,o)}},{key:"handleContextMenu",value:function(e){var t=this.props,n=t.row,o=t.col,r=t.onContextMenu;t.cell.disableEvents||r(e,n,o)}},{key:"handleKey",value:function(e){var t=e.which||e.keyCode;if(t===u.ESCAPE_KEY){var n=this.props,o=n.setCellContent,r=n.row,i=n.col;return o&&o(this.initialContent,r,i),this.handleRevert()}(t===u.ENTER_KEY||t===u.TAB_KEY||[u.LEFT_KEY,u.RIGHT_KEY,u.UP_KEY,u.DOWN_KEY].includes(t))&&this.handleCommit(e)}},{key:"renderComponent",value:function(e,t){var n=t.component,o=t.readOnly,r=t.forceComponent;if(e&&!o||r)return n}},{key:"render",value:function(){var e=this.props,t=e.row,n=e.col,o=e.cell,r=e.cellRenderer,a=e.attributesRenderer,u=e.selected,l=e.editing,s=e.onKeyUp,d=this.renderComponent(l,o),f=[o.className,"cell",o.overflow,u&&"selected",l&&"editing",o.readOnly&&"read-only"].filter((function(e){return e})).join(" ");return i.default.createElement(r,{row:t,col:n,cell:o,selected:u,editing:l,attributesRenderer:a,className:f,style:c(o),onMouseDown:this.handleMouseDown,onMouseOver:this.handleMouseOver,onDoubleClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,onKeyUp:s,onRevert:this.handleRevert,onKeyDown:this.handleKey},d)}}]),t}(r.PureComponent);t.default=f,f.propTypes={row:a.default.number.isRequired,col:a.default.number.isRequired,cell:a.default.shape(s.default).isRequired,forceEdit:a.default.bool,selected:a.default.bool,editing:a.default.bool,editValue:a.default.any,cellRenderer:a.default.func,valueRenderer:a.default.func.isRequired,dataRenderer:a.default.func,valueViewer:a.default.func,dataEditor:a.default.func,attributesRenderer:a.default.func,onNavigate:a.default.func.isRequired,onMouseDown:a.default.func.isRequired,onMouseOver:a.default.func.isRequired,onDoubleClick:a.default.func.isRequired,onContextMenu:a.default.func.isRequired,onChange:a.default.func.isRequired,onRevert:a.default.func.isRequired,onEdit:a.default.func},f.defaultProps={forceEdit:!1,selected:!1,editing:!1,cellRenderer:l.default}},772:function(e,t,n){"use strict";function o(e,t,n,o){var r=o(e,t,n);return null==r?"":r}Object.defineProperty(t,"__esModule",{value:!0}),t.renderValue=o,t.renderData=function(e,t,n,r,i){var a=i?i(e,t,n):null;return null==a?o(e,t,n,r):a}}}]);