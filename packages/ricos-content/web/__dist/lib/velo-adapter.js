import _extends from"@babel/runtime/helpers/extends";import _objectWithoutPropertiesLoose from"@babel/runtime/helpers/objectWithoutPropertiesLoose";import{isString,isArray,isNumber,isObject,flow as flow$1}from"lodash";import"uuid";function identity(a){return a}var unsafeCoerce=identity;function constant(a){return function(){return a}}function flow(ab,bc,cd,de,ef,fg,gh,hi,ij){switch(arguments.length){case 1:return ab;case 2:return function(){return bc(ab.apply(this,arguments))};case 3:return function(){return cd(bc(ab.apply(this,arguments)))};case 4:return function(){return de(cd(bc(ab.apply(this,arguments))))};case 5:return function(){return ef(de(cd(bc(ab.apply(this,arguments)))))};case 6:return function(){return fg(ef(de(cd(bc(ab.apply(this,arguments))))))};case 7:return function(){return gh(fg(ef(de(cd(bc(ab.apply(this,arguments)))))))};case 8:return function(){return hi(gh(fg(ef(de(cd(bc(ab.apply(this,arguments))))))))};case 9:return function(){return ij(hi(gh(fg(ef(de(cd(bc(ab.apply(this,arguments)))))))))}}}function pipe$1(a,ab,bc,cd,de,ef,fg,gh,hi,ij,jk,kl,lm,mn,no,op,pq,qr,rs,st){switch(arguments.length){case 1:return a;case 2:return ab(a);case 3:return bc(ab(a));case 4:return cd(bc(ab(a)));case 5:return de(cd(bc(ab(a))));case 6:return ef(de(cd(bc(ab(a)))));case 7:return fg(ef(de(cd(bc(ab(a))))));case 8:return gh(fg(ef(de(cd(bc(ab(a)))))));case 9:return hi(gh(fg(ef(de(cd(bc(ab(a))))))));case 10:return ij(hi(gh(fg(ef(de(cd(bc(ab(a)))))))));case 11:return jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a))))))))));case 12:return kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a)))))))))));case 13:return lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a))))))))))));case 14:return mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a)))))))))))));case 15:return no(mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a))))))))))))));case 16:return op(no(mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a)))))))))))))));case 17:return pq(op(no(mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a))))))))))))))));case 18:return qr(pq(op(no(mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a)))))))))))))))));case 19:return rs(qr(pq(op(no(mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a))))))))))))))))));case 20:return st(rs(qr(pq(op(no(mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a)))))))))))))))))))}}var SK=function(_,b){return b},__spreadArray$1=function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},isSome=function(fa){return"Some"===fa._tag},none$1={_tag:"None"},some$2=function(a){return{_tag:"Some",value:a}},isLeft$1=function(ma){return"Left"===ma._tag},left$2=function(e){return{_tag:"Left",left:e}},right$2=function(a){return{_tag:"Right",right:a}},has=Object.prototype.hasOwnProperty;function fromPredicate$3(F){return function(predicate,onFalse){return function(a){return F.fromEither(predicate(a)?right$2(a):left$2(onFalse(a)))}}}var first=function(){return{concat:identity}},concatAll=function(M){return function(startWith){return function(as){return as.reduce((function(a,acc){return M.concat(a,acc)}),startWith)}}},unsafeUpdateAt$2=function(i,a,as){if(as[i]===a)return as;var xs=function(as){return __spreadArray$1([as[0]],as.slice(1))}(as);return xs[i]=a,xs},__spreadArray=function(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to},separated=function(left,right){return{left:left,right:right}};function wiltDefault(T,C){return function(F){var traverseF=T.traverse(F);return function(wa,f){return F.map(traverseF(wa,f),C.separate)}}}function witherDefault(T,C){return function(F){var traverseF=T.traverse(F);return function(wa,f){return F.map(traverseF(wa,f),C.compact)}}}var isNonEmpty=function(as){return as.length>0},isOutOfBound=function(i,as){return i<0||i>=as.length};function lookup$1(i,as){return void 0===as?function(as){return lookup$1(i,as)}:isOutOfBound(i,as)?none$1:some$2(as[i])}var findIndex$1=function(predicate){return function(as){for(var i=0;i<as.length;i++)if(predicate(as[i]))return some$2(i);return none$1}};function findFirst$1(predicate){return function(as){for(var i=0;i<as.length;i++)if(predicate(as[i]))return some$2(as[i]);return none$1}}var unsafeUpdateAt$1=function(i,a,as){return isNonEmpty(as)?unsafeUpdateAt$2(i,a,as):as},append=function(end){return function(init){return __spreadArray(__spreadArray([],init),[end])}},findIndex=findIndex$1,of$2=function(a){return[a]},map$5=function(f){return function(fa){return fa.map((function(a){return f(a)}))}},reduceWithIndex$1=function(b,f){return function(fa){for(var len=fa.length,out=b,i=0;i<len;i++)out=f(i,out,fa[i]);return out}},traverseWithIndex=function(F){return function(f){return reduceWithIndex$1(F.of([]),(function(i,fbs,a){return F.ap(F.map(fbs,(function(bs){return function(b){return pipe$1(bs,append(b))}})),f(i,a))}))}},none=none$1,some$1=some$2;function fromPredicate$2(predicate){return function(a){return predicate(a)?some$1(a):none}}var getRight=function(ma){return"Left"===ma._tag?none:some$1(ma.right)},_map$3=function(fa,f){return pipe$1(fa,map$4(f))},map$4=function(f){return function(fa){return isNone(fa)?none:some$1(f(fa.value))}},chain$1=function(f){return function(ma){return isNone(ma)?none:f(ma.value)}},fromEither=getRight,isNone=function(fa){return"None"===fa._tag},fold$2=function(onNone,onSome){return function(ma){return isNone(ma)?onNone():onSome(ma.value)}},getOrElse=function(onNone){return function(ma){return isNone(ma)?onNone():ma.value}},fromNullable$1=function(a){return null==a?none:some$1(a)},option_map=_map$3,getFirstMonoid=function(){return S=first(),{concat:function(x,y){return isNone(x)?y:isNone(y)?x:some$1(S.concat(x.value,y.value))},empty:none};var S},left$1=left$2,right$1=right$2,fromPredicate$1=fromPredicate$3({URI:"Either",fromEither:identity}),isLeft=isLeft$1,fold$1=function(onLeft,onRight){return function(ma){return isLeft(ma)?onLeft(ma.left):onRight(ma.right)}},monoidAll={concat:function(x,y){return x&&y},empty:!0},monoidAny={concat:function(x,y){return x||y},empty:!1},firstRight=function(candidate,defaultT,resolvers){var S,firstRightSemi=(S=first(),{concat:function(x,y){return isLeft(y)?x:isLeft(x)?y:right$1(S.concat(x.right,y.right))}});return pipe$1(concatAll(firstRightSemi)(left$1(defaultT))(pipe$1(resolvers,map$5((function(r){return pipe$1(candidate,fromPredicate$1(r[0],(function(){return defaultT})),(f=r[1],function(fa){return isLeft(fa)?fa:right$1(f(fa.right))}));var f})))),fold$1(identity,identity))};function unfoldTree(b,f){var _a=f(b);return{value:_a[0],forest:unfoldForest(_a[1],f)}}function unfoldForest(bs,f){return bs.map((function(b){return unfoldTree(b,f)}))}var chain=function(f){return function(ma){var _a=f(ma.value);return{value:_a.value,forest:function(first,second){return first.concat(second)}(_a.forest,ma.forest.map(chain(f)))}}},extend=function(f){return function(wa){return{value:f(wa),forest:wa.forest.map(extend(f))}}},map$2=function(f){return function(fa){return{value:f(fa.value),forest:fa.forest.map(map$2(f))}}},reduce$1=function(b,f){return function(fa){for(var r=f(b,fa.value),len=fa.forest.length,i=0;i<len;i++)r=pipe$1(fa.forest[i],reduce$1(r,f));return r}},foldMap$1=function(M){return function(f){return reduce$1(M.empty,(function(acc,a){return M.concat(acc,f(a))}))}},reduceRight$1=function(b,f){return function(fa){for(var r=b,i=fa.forest.length-1;i>=0;i--)r=pipe$1(fa.forest[i],reduceRight$1(r,f));return f(fa.value,r)}},traverse$1=function(F){var traverseF=function(F){var traverseWithIndexF=traverseWithIndex(F);return function(f){return traverseWithIndexF((function(_,a){return f(a)}))}}(F),out=function(f){return function(ta){return F.ap(F.map(f(ta.value),(function(value){return function(forest){return{value:value,forest:forest}}})),pipe$1(ta.forest,traverseF(out(f))))}};return out},tree={URI:"Tree",map:function(fa,f){return pipe$1(fa,map$2(f))},of:function(a){return void 0===forest&&(forest=[]),{value:a,forest:forest};var forest},ap:function(fab,fa){return pipe$1(fab,chain((function(f){return pipe$1(fa,map$2(f))})))},chain:function(ma,f){return pipe$1(ma,chain(f))},reduce:function(fa,b,f){return pipe$1(fa,reduce$1(b,f))},foldMap:function(M){var foldMapM=foldMap$1(M);return function(fa,f){return pipe$1(fa,foldMapM(f))}},reduceRight:function(fa,b,f){return pipe$1(fa,reduceRight$1(b,f))},traverse:function(F){var traverseF=traverse$1(F);return function(ta,f){return pipe$1(ta,traverseF(f))}},sequence:function(F){return traverse$1(F)(identity)},extract:function(wa){return wa.value},extend:function(wa,f){return pipe$1(wa,extend(f))}},make=unsafeCoerce;function getApplicative(M){var S,A=(S=M,{URI:URI$2,_E:void 0,map:_map$1,ap:function(fab,fa){return make(S.concat(fab,fa))}});return{URI:URI$2,_E:void 0,map:A.map,ap:A.ap,of:function(){return make(M.empty)}}}var _map$1=function(fa,f){return pipe$1(fa,map$1(f))},map$1=function(){return unsafeCoerce},URI$2="Const",pipe=pipe$1,Ord={equals:function(first,second){return first===second},compare:function(first,second){return first<second?-1:first>second?1:0}},keys_=function(O){return function(r){return Object.keys(r).sort(O.compare)}};function lookup(k,r){return void 0===r?function(r){return lookup(k,r)}:has.call(r,k)?some$2(r[k]):none$1}var empty={};function mapWithIndex(f){return function(r){var out={};for(var k in r)has.call(r,k)&&(out[k]=f(k,r[k]));return out}}function reduceWithIndex(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];if(2===args.length)return reduceWithIndex(Ord).apply(void 0,args);var keysO=keys_(args[0]);return function(b,f){return function(fa){for(var out=b,ks=keysO(fa),len=ks.length,i=0;i<len;i++){var k=ks[i];out=f(k,out,fa[k])}return out}}}function foldMapWithIndex(O){if("compare"in O){var keysO_1=keys_(O);return function(M){return function(f){return function(fa){for(var out=M.empty,ks=keysO_1(fa),len=ks.length,i=0;i<len;i++){var k=ks[i];out=M.concat(out,f(k,fa[k]))}return out}}}}return foldMapWithIndex(Ord)(O)}function reduceRightWithIndex(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];if(2===args.length)return reduceRightWithIndex(Ord).apply(void 0,args);var keysO=keys_(args[0]);return function(b,f){return function(fa){for(var out=b,ks=keysO(fa),i=ks.length-1;i>=0;i--){var k=ks[i];out=f(k,fa[k],out)}return out}}}function sequence(F){return _sequence(Ord)(F)}var _map=function(fa,f){return pipe$1(fa,function(f){return mapWithIndex((function(_,a){return f(a)}))}(f))},_reduce=function(O){var reduceO=reduce(O);return function(fa,b,f){return pipe$1(fa,reduceO(b,f))}},_foldMap=function(O){return function(M){var foldMapM=foldMap(O)(M);return function(fa,f){return pipe$1(fa,foldMapM(f))}}},_reduceRight=function(O){var reduceRightO=reduceRight(O);return function(fa,b,f){return pipe$1(fa,reduceRightO(b,f))}},_reduceWithIndex=function(O){var reduceWithIndexO=reduceWithIndex(O);return function(fa,b,f){return pipe$1(fa,reduceWithIndexO(b,f))}},_foldMapWithIndex=function(O){var foldMapWithIndexO=foldMapWithIndex(O);return function(M){var foldMapWithIndexM=foldMapWithIndexO(M);return function(fa,f){return pipe$1(fa,foldMapWithIndexM(f))}}},_reduceRightWithIndex=function(O){var reduceRightWithIndexO=reduceRightWithIndex(O);return function(fa,b,f){return pipe$1(fa,reduceRightWithIndexO(b,f))}},_traverse=function(O){var traverseWithIndexO=_traverseWithIndex(O);return function(F){var traverseWithIndexOF=traverseWithIndexO(F);return function(ta,f){return traverseWithIndexOF(ta,flow(SK,f))}}},_sequence=function(O){var traverseO=_traverse(O);return function(F){var traverseOF=traverseO(F);return function(ta){return traverseOF(ta,identity)}}},_traverseWithIndex=function(O){return function(F){var keysO=keys_(O);return function(ta,f){var ks=keysO(ta);if(0===ks.length)return F.of(empty);for(var fr=F.of({}),_loop_1=function(key){fr=F.ap(F.map(fr,(function(r){return function(b){return r[key]=b,r}})),f(key,ta[key]))},_i=0,ks_1=ks;_i<ks_1.length;_i++){_loop_1(ks_1[_i])}return fr}}};function reduce(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];if(1===args.length){var reduceWithIndexO_1=reduceWithIndex(args[0]);return function(b,f){return reduceWithIndexO_1(b,(function(_,b,a){return f(b,a)}))}}return reduce(Ord).apply(void 0,args)}function foldMap(O){if("compare"in O){var foldMapWithIndexO_1=foldMapWithIndex(O);return function(M){var foldMapWithIndexM=foldMapWithIndexO_1(M);return function(f){return foldMapWithIndexM((function(_,a){return f(a)}))}}}return foldMap(Ord)(O)}function reduceRight(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];if(1===args.length){var reduceRightWithIndexO_1=reduceRightWithIndex(args[0]);return function(b,f){return reduceRightWithIndexO_1(b,(function(_,b,a){return f(b,a)}))}}return reduceRight(Ord).apply(void 0,args)}var compact=function(r){var out={};for(var k in r)if(has.call(r,k)){var oa=r[k];isSome(oa)&&(out[k]=oa.value)}return out},separate=function(r){var left={},right={};for(var k in r)if(has.call(r,k)){var e=r[k];isLeft$1(e)?left[k]=e.left:right[k]=e.right}return separated(left,right)},URI$1="ReadonlyRecord",Compactable={URI:URI$1,compact:compact,separate:separate};_reduce(Ord),_foldMap(Ord),_reduceRight(Ord),_reduce(Ord),_foldMap(Ord),_reduceRight(Ord),_reduceWithIndex(Ord),_foldMapWithIndex(Ord),_reduceRightWithIndex(Ord);var Traversable={URI:URI$1,map:_map,reduce:_reduce(Ord),foldMap:_foldMap(Ord),reduceRight:_reduceRight(Ord),traverse:_traverse(Ord),sequence:sequence};_reduce(Ord),_foldMap(Ord),_reduceRight(Ord),_reduceWithIndex(Ord),_foldMapWithIndex(Ord),_reduceRightWithIndex(Ord),_traverse(Ord),_traverseWithIndex(Ord);witherDefault(Traversable,Compactable),wiltDefault(Traversable,Compactable);_reduce(Ord),_foldMap(Ord),_reduceRight(Ord),_traverse(Ord);var insertAt=function(k,a){return function(r){if(has.call(r,k)&&r[k]===a)return r;var out=Object.assign({},r);return out[k]=a,out}};_reduce(Ord),_foldMap(Ord),_reduceRight(Ord),_traverse(Ord),_reduceWithIndex(Ord),_foldMapWithIndex(Ord),_reduceRightWithIndex(Ord),_traverseWithIndex(Ord);var __spreadArrays=function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;var r=Array(s),k=0;for(i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r},isoAsLens=function(sa){return lens$2(sa.get,flow(sa.reverseGet,constant))},lens$2=function(get,set){return{get:get,set:set}},lensAsOptional=function(sa){return optional(flow(sa.get,some$1),sa.set)},lensComposeLens=function(ab){return function(sa){return lens$2((function(s){return ab.get(sa.get(s))}),(function(b){return function(s){return sa.set(ab.set(b)(sa.get(s)))(s)}}))}},prism=function(getOption,reverseGet){return{getOption:getOption,reverseGet:reverseGet}},prismAsOptional=function(sa){return optional(sa.getOption,(function(a){return prismSet(a)(sa)}))},prismAsTraversal=function(sa){return traversal((function(F){return function(f){return function(s){return pipe(sa.getOption(s),fold$2((function(){return F.of(s)}),(function(a){return F.map(f(a),(function(a){return prismSet(a)(sa)(s)}))})))}}}))},prismModify=function(f){return function(sa){var g=function(f){return function(sa){return function(s){return pipe(sa.getOption(s),map$4((function(o){var n=f(o);return n===o?s:sa.reverseGet(n)})))}}}(f)(sa);return function(s){return pipe(g(s),getOrElse((function(){return s})))}}},prismSet=function(a){return prismModify((function(){return a}))},prismFromNullable=function(){return prism(fromNullable$1,identity)},prismFromPredicate=function(predicate){return prism(fromPredicate$2(predicate),identity)},prismSome=function(){return prism(identity,some$1)},prismRight=function(){return prism(fromEither,right$1)},prismLeft=function(){return prism((function(s){return isLeft(s)?some$1(s.left):none}),left$1)},optional=function(getOption,set){return{getOption:getOption,set:set}},optionalModifyOption=function(f){return function(optional){return function(s){return pipe(optional.getOption(s),map$4((function(a){var n=f(a);return n===a?s:optional.set(n)(s)})))}}},optionalModify=function(f){return function(optional){var g=optionalModifyOption(f)(optional);return function(s){return pipe(g(s),getOrElse((function(){return s})))}}},optionalComposeOptional=function(ab){return function(sa){return optional(flow(sa.getOption,chain$1(ab.getOption)),(function(b){return optionalModify(ab.set(b))(sa)}))}},unsafeUpdateAt=function(i,a,as){if(as[i]===a)return as;var xs=__spreadArrays([as[0]],as.slice(1));return xs[i]=a,xs},traversal=function(modifyF){return{modifyF:modifyF}};function traversalComposeTraversal(ab){return function(sa){return traversal((function(F){return function(f){return sa.modifyF(F)(ab.modifyF(F)(f))}}))}}var ApplicativeIdentity={URI:"Identity",map:function(fa,f){return f(fa)},of:identity,ap:function(fab,fa){return fab(fa)}};function fromTraversable$2(T){return function(){return traversal((function(F){var traverseF=function(F){return"Identity"===F.URI}(F)?T.map:T.traverse(F);return function(f){return function(s){return traverseF(s,f)}}}))}}var index$1=function(index){return{index:index}},indexReadonlyArray=function(){return index$1((function(i){return optional((function(as){return lookup$1(i,as)}),(function(a){return function(as){return pipe(lookup$1(i,as),fold$2((function(){return as}),(function(){return unsafeUpdateAt$1(i,a,as)})))}}))}))},indexReadonlyNonEmptyArray=function(){return index$1((function(i){return optional((function(as){return lookup$1(i,as)}),(function(a){return function(as){return pipe(lookup$1(i,as),fold$2((function(){return as}),(function(){return unsafeUpdateAt(i,a,as)})))}}))}))},indexReadonlyRecord=function(){return index$1((function(k){return optional((function(r){return lookup(k,r)}),(function(a){return function(r){return r[k]===a||isNone(lookup(k,r))?r:insertAt(k,a)(r)}}))}))};var asLens=isoAsLens,asPrism=function(sa){return prism(flow(sa.get,some$1),sa.reverseGet)},asOptional$2=function(sa){return optional(flow(sa.get,some$1),flow(sa.reverseGet,constant))},asTraversal$3=function(sa){return traversal((function(F){return function(f){return function(s){return F.map(f(sa.get(s)),(function(a){return sa.reverseGet(a)}))}}}))},lens=lens$2,id=function(){return lens$2(identity,constant)},asOptional$1=lensAsOptional,asTraversal$2=function(sa){return traversal((function(F){return function(f){return function(s){return F.map(f(sa.get(s)),(function(a){return sa.set(a)(s)}))}}}))},compose$3=lensComposeLens,composeLens$1=compose$3,composeIso=flow(isoAsLens,compose$3),composePrism=function(ab){return function(sa){return optionalComposeOptional(prismAsOptional(ab))(lensAsOptional(sa))}},composeOptional=function(ab){return flow(asOptional$1,optionalComposeOptional(ab))},modify$4=function(f){return function(sa){return function(s){var o=sa.get(s),n=f(o);return o===n?s:sa.set(n)(s)}}};var prop=function(prop){return function(sa){return lens$2((function(s){return sa.get(s)[prop]}),(function(ap){return function(s){var _a,oa=sa.get(s);return ap===oa[prop]?s:sa.set(Object.assign({},oa,((_a={})[prop]=ap,_a)))(s)}}))}},props=function(){for(var props=[],_i=0;_i<arguments.length;_i++)props[_i]=arguments[_i];return function(sa){return lens$2((function(s){for(var a=sa.get(s),r={},_i=0,props_1=props;_i<props_1.length;_i++){var k=props_1[_i];r[k]=a[k]}return r}),(function(a){return function(s){for(var oa=sa.get(s),_i=0,props_2=props;_i<props_2.length;_i++){var k=props_2[_i];if(a[k]!==oa[k])return sa.set(Object.assign({},oa,a))(s)}return s}}))}},component=function(prop){return function(sa){return lens$2((function(s){return sa.get(s)[prop]}),(function(ap){return function(s){var oa=sa.get(s);if(ap===oa[prop])return s;var copy=oa.slice();return copy[prop]=ap,sa.set(copy)(s)}}))}},atKey=function(key){return function(sa){return pipe(sa,lensComposeLens(function(at){return{at:at}}((function(key){return lens$2((function(r){return lookup(key,r)}),fold$2((function(){return k=key,function(r){if(!has.call(r,k))return r;var out=Object.assign({},r);return delete out[k],out};var k}),(function(a){return insertAt(key,a)})))})).at(key)))}},some=composePrism(prismSome()),right=composePrism(prismRight()),left=composePrism(prismLeft());var imap_=function(ea,ab,ba){return lens(flow(ea.get,ab),flow(ba,ea.set))},URI="monocle-ts/Lens",Invariant={URI:URI,imap:imap_},Semigroupoid={URI:URI,compose:function(ab,ea){return compose$3(ab)(ea)}},Category={URI:URI,compose:Semigroupoid.compose,id:id},lens$1=Object.freeze({__proto__:null,lens:lens,id:id,asOptional:asOptional$1,asTraversal:asTraversal$2,compose:compose$3,composeLens:composeLens$1,composeIso:composeIso,composePrism:composePrism,composeOptional:composeOptional,composeTraversal:function(ab){return flow(asTraversal$2,traversalComposeTraversal(ab))},modify:modify$4,modifyF:function(F){return function(f){return function(sa){return function(s){return pipe(sa.get(s),f,(function(fa){return F.map(fa,(function(a){return sa.set(a)(s)}))}))}}}},fromNullable:function(sa){return composePrism(prismFromNullable())(sa)},filter:function(predicate){return composePrism(prismFromPredicate(predicate))},prop:prop,props:props,component:component,index:function(i){return flow(asOptional$1,function(i){return function(sa){return pipe(sa,optionalComposeOptional(indexReadonlyArray().index(i)))}}(i))},indexNonEmpty:function(i){return flow(asOptional$1,function(i){return function(sa){return pipe(sa,optionalComposeOptional(indexReadonlyNonEmptyArray().index(i)))}}(i))},key:function(key){return flow(asOptional$1,function(key){return function(sa){return pipe(sa,optionalComposeOptional(indexReadonlyRecord().index(key)))}}(key))},atKey:atKey,some:some,right:right,left:left,traverse:function(T){return flow(asTraversal$2,function(T){return traversalComposeTraversal(fromTraversable$2(T)())}(T))},findFirst:function(predicate){return composeOptional(function(predicate){return optional(findFirst$1(predicate),(function(a){return function(s){return pipe(findIndex$1(predicate)(s),fold$2((function(){return s}),(function(i){return unsafeUpdateAt$1(i,a,s)})))}}))}(predicate))},findFirstNonEmpty:function(predicate){return composeOptional(function(predicate){return optional(findFirst$1(predicate),(function(a){return function(as){return pipe(findIndex$1(predicate)(as),fold$2((function(){return as}),(function(i){return unsafeUpdateAt(i,a,as)})))}}))}(predicate))},imap:function(f,g){return function(ea){return imap_(ea,f,g)}},URI:URI,Invariant:Invariant,Semigroupoid:Semigroupoid,Category:Category}),asTraversal$1=function(sa){return traversal((function(F){return function(f){return function(s){return pipe(sa.getOption(s),fold$2((function(){return F.of(s)}),(function(a){return F.map(f(a),(function(a){return sa.set(a)(s)}))})))}}}))},compose$2=optionalComposeOptional,modifyOption=optionalModifyOption,modify$3=optionalModify;prismAsOptional(prismFromNullable()),prismAsOptional(prismSome()),prismAsOptional(prismRight()),prismAsOptional(prismLeft());var fromPredicate=prismFromPredicate,asOptional=prismAsOptional,asTraversal=prismAsTraversal,compose$1=function(ab){return function(sa){return prism(flow(sa.getOption,chain$1(ab.getOption)),flow(ab.reverseGet,sa.reverseGet))}},composeLens=function(ab){return function(sa){return optionalComposeOptional(lensAsOptional(ab))(prismAsOptional(sa))}},fromTraversable$1=fromTraversable$2,compose=traversalComposeTraversal,modify$2=function(f){return function(sa){return sa.modifyF(ApplicativeIdentity)(f)}};var fromLens=function(lens){return new Lens(lens.get,lens.set)},fromPrism=function(prism){return new Prism(prism.getOption,prism.reverseGet)},fromOptional=function(optional){return new Optional(optional.getOption,optional.set)},fromTraversal=function(traversal){return new Traversal(traversal.modifyF)},update=function(o,k,a){var _a;return a===o[k]?o:Object.assign({},o,((_a={})[k]=a,_a))},Lens=function(){function Lens(get,set){this.get=get,this.set=set,this._tag="Lens"}return Lens.fromPath=function(){var fromProp=Lens.fromProp();return function(path){var lens=fromProp(path[0]);return path.slice(1).reduce((function(acc,prop){return acc.compose(fromProp(prop))}),lens)}},Lens.fromProp=function(){return function(prop$1){return fromLens(pipe(id(),prop(prop$1)))}},Lens.fromProps=function(){return function(props$1){return fromLens(pipe(id(),props.apply(lens$1,props$1)))}},Lens.fromNullableProp=function(){return function(k,defaultValue){return new Lens((function(s){var osk=fromNullable$1(s[k]);return isNone(osk)?defaultValue:osk.value}),(function(a){return function(s){return update(s,k,a)}}))}},Lens.prototype.modify=function(f){return modify$4(f)(this)},Lens.prototype.asOptional=function(){return fromOptional(asOptional$1(this))},Lens.prototype.asTraversal=function(){return fromTraversal(asTraversal$2(this))},Lens.prototype.asSetter=function(){var _this=this;return new Setter((function(f){return _this.modify(f)}))},Lens.prototype.asGetter=function(){var _this=this;return new Getter((function(s){return _this.get(s)}))},Lens.prototype.asFold=function(){var _this=this;return new Fold((function(){return function(f){return function(s){return f(_this.get(s))}}}))},Lens.prototype.compose=function(ab){return fromLens(compose$3(ab)(this))},Lens.prototype.composeLens=function(ab){return this.compose(ab)},Lens.prototype.composeGetter=function(ab){return this.asGetter().compose(ab)},Lens.prototype.composeFold=function(ab){return this.asFold().compose(ab)},Lens.prototype.composeOptional=function(ab){return fromOptional(pipe(this,asOptional$1,compose$2(ab)))},Lens.prototype.composeTraversal=function(ab){return fromTraversal(pipe(this,asTraversal$2,compose(ab)))},Lens.prototype.composeSetter=function(ab){return this.asSetter().compose(ab)},Lens.prototype.composeIso=function(ab){return fromLens(pipe(this,compose$3(pipe(ab,asLens))))},Lens.prototype.composePrism=function(ab){return fromOptional(composePrism(ab)(this))},Lens}(),Prism=function(){function Prism(getOption,reverseGet){this.getOption=getOption,this.reverseGet=reverseGet,this._tag="Prism"}return Prism.fromPredicate=function(predicate){return fromPrism(fromPredicate(predicate))},Prism.some=function(){return somePrism},Prism.prototype.modify=function(f){var _this=this;return function(s){var os=_this.modifyOption(f)(s);return isNone(os)?s:os.value}},Prism.prototype.modifyOption=function(f){var _this=this;return function(s){return option_map(_this.getOption(s),(function(v){var n=f(v);return n===v?s:_this.reverseGet(n)}))}},Prism.prototype.set=function(a){return this.modify((function(){return a}))},Prism.prototype.asOptional=function(){return fromOptional(asOptional(this))},Prism.prototype.asTraversal=function(){return fromTraversal(asTraversal(this))},Prism.prototype.asSetter=function(){var _this=this;return new Setter((function(f){return _this.modify(f)}))},Prism.prototype.asFold=function(){var _this=this;return new Fold((function(M){return function(f){return function(s){var oa=_this.getOption(s);return isNone(oa)?M.empty:f(oa.value)}}}))},Prism.prototype.compose=function(ab){return fromPrism(compose$1(ab)(this))},Prism.prototype.composePrism=function(ab){return this.compose(ab)},Prism.prototype.composeOptional=function(ab){return fromOptional(pipe(this,asOptional,compose$2(ab)))},Prism.prototype.composeTraversal=function(ab){return fromTraversal(pipe(this,asTraversal,compose(ab)))},Prism.prototype.composeFold=function(ab){return this.asFold().compose(ab)},Prism.prototype.composeSetter=function(ab){return this.asSetter().compose(ab)},Prism.prototype.composeIso=function(ab){return fromPrism(pipe(this,compose$1(pipe(ab,asPrism))))},Prism.prototype.composeLens=function(ab){return fromOptional(composeLens(ab)(this))},Prism.prototype.composeGetter=function(ab){return this.asFold().compose(ab.asFold())},Prism}(),somePrism=new Prism(identity,some$1),Optional=function(){function Optional(getOption,set){this.getOption=getOption,this.set=set,this._tag="Optional"}return Optional.fromPath=function(){var fromNullableProp=Optional.fromNullableProp();return function(path){var optional=fromNullableProp(path[0]);return path.slice(1).reduce((function(acc,prop){return acc.compose(fromNullableProp(prop))}),optional)}},Optional.fromNullableProp=function(){return function(k){return new Optional((function(s){return fromNullable$1(s[k])}),(function(a){return function(s){return null==s[k]?s:update(s,k,a)}}))}},Optional.fromOptionProp=function(){var formProp=Lens.fromProp();return function(prop){return formProp(prop).composePrism(somePrism)}},Optional.prototype.modify=function(f){return modify$3(f)(this)},Optional.prototype.modifyOption=function(f){return modifyOption(f)(this)},Optional.prototype.asTraversal=function(){return fromTraversal(asTraversal$1(this))},Optional.prototype.asFold=function(){var _this=this;return new Fold((function(M){return function(f){return function(s){var oa=_this.getOption(s);return isNone(oa)?M.empty:f(oa.value)}}}))},Optional.prototype.asSetter=function(){var _this=this;return new Setter((function(f){return _this.modify(f)}))},Optional.prototype.compose=function(ab){return fromOptional(compose$2(ab)(this))},Optional.prototype.composeOptional=function(ab){return this.compose(ab)},Optional.prototype.composeTraversal=function(ab){return fromTraversal(pipe(this,asTraversal$1,compose(ab)))},Optional.prototype.composeFold=function(ab){return this.asFold().compose(ab)},Optional.prototype.composeSetter=function(ab){return this.asSetter().compose(ab)},Optional.prototype.composeLens=function(ab){return fromOptional(pipe(this,compose$2(pipe(ab,asOptional$1))))},Optional.prototype.composePrism=function(ab){return fromOptional(pipe(this,compose$2(pipe(ab,asOptional))))},Optional.prototype.composeIso=function(ab){return fromOptional(pipe(this,compose$2(pipe(ab,asOptional$2))))},Optional.prototype.composeGetter=function(ab){return this.asFold().compose(ab.asFold())},Optional}(),Traversal=function(){function Traversal(modifyF){this.modifyF=modifyF,this._tag="Traversal"}return Traversal.prototype.modify=function(f){return modify$2(f)(this)},Traversal.prototype.set=function(a){return function(a){return modify$2((function(){return a}))}(a)(this)},Traversal.prototype.filter=function(predicate){return fromTraversal(function(predicate){return compose(prismAsTraversal(prismFromPredicate(predicate)))}(predicate)(this))},Traversal.prototype.asFold=function(){var _this=this;return new Fold((function(M){return function(f){return _this.modifyF(getApplicative(M))((function(a){return make(f(a))}))}}))},Traversal.prototype.asSetter=function(){var _this=this;return new Setter((function(f){return _this.modify(f)}))},Traversal.prototype.compose=function(ab){return fromTraversal(compose(ab)(this))},Traversal.prototype.composeTraversal=function(ab){return this.compose(ab)},Traversal.prototype.composeFold=function(ab){return this.asFold().compose(ab)},Traversal.prototype.composeSetter=function(ab){return this.asSetter().compose(ab)},Traversal.prototype.composeOptional=function(ab){return this.compose(ab.asTraversal())},Traversal.prototype.composeLens=function(ab){return fromTraversal(pipe(this,compose(pipe(ab,asTraversal$2))))},Traversal.prototype.composePrism=function(ab){return fromTraversal(pipe(this,compose(pipe(ab,asTraversal))))},Traversal.prototype.composeIso=function(ab){return fromTraversal(pipe(this,compose(pipe(ab,asTraversal$3))))},Traversal.prototype.composeGetter=function(ab){return this.asFold().compose(ab.asFold())},Traversal}(),Getter=function(){function Getter(get){this.get=get,this._tag="Getter"}return Getter.prototype.asFold=function(){var _this=this;return new Fold((function(){return function(f){return function(s){return f(_this.get(s))}}}))},Getter.prototype.compose=function(ab){var _this=this;return new Getter((function(s){return ab.get(_this.get(s))}))},Getter.prototype.composeGetter=function(ab){return this.compose(ab)},Getter.prototype.composeFold=function(ab){return this.asFold().compose(ab)},Getter.prototype.composeLens=function(ab){return this.compose(ab.asGetter())},Getter.prototype.composeIso=function(ab){return this.compose(ab.asGetter())},Getter.prototype.composeTraversal=function(ab){return this.asFold().compose(ab.asFold())},Getter.prototype.composeOptional=function(ab){return this.asFold().compose(ab.asFold())},Getter.prototype.composePrism=function(ab){return this.asFold().compose(ab.asFold())},Getter}(),Fold=function(){function Fold(foldMap){this.foldMap=foldMap,this._tag="Fold",this.getAll=foldMap({concat:function(first,second){return first.concat(second)},empty:[]})(of$2),this.exist=foldMap(monoidAny),this.all=foldMap(monoidAll),this.foldMapFirst=foldMap(getFirstMonoid())}return Fold.prototype.compose=function(ab){var _this=this;return new Fold((function(M){return function(f){return _this.foldMap(M)(ab.foldMap(M)(f))}}))},Fold.prototype.composeFold=function(ab){return this.compose(ab)},Fold.prototype.composeGetter=function(ab){return this.compose(ab.asFold())},Fold.prototype.composeTraversal=function(ab){return this.compose(ab.asFold())},Fold.prototype.composeOptional=function(ab){return this.compose(ab.asFold())},Fold.prototype.composeLens=function(ab){return this.compose(ab.asFold())},Fold.prototype.composePrism=function(ab){return this.compose(ab.asFold())},Fold.prototype.composeIso=function(ab){return this.compose(ab.asFold())},Fold.prototype.find=function(p){return this.foldMapFirst(fromPredicate$2(p))},Fold.prototype.headOption=function(s){return this.find((function(){return!0}))(s)},Fold}(),Setter=function(){function Setter(modify){this.modify=modify,this._tag="Setter"}return Setter.prototype.set=function(a){return this.modify(constant(a))},Setter.prototype.compose=function(ab){var _this=this;return new Setter((function(f){return _this.modify(ab.modify(f))}))},Setter.prototype.composeSetter=function(ab){return this.compose(ab)},Setter.prototype.composeTraversal=function(ab){return this.compose(ab.asSetter())},Setter.prototype.composeOptional=function(ab){return this.compose(ab.asSetter())},Setter.prototype.composeLens=function(ab){return this.compose(ab.asSetter())},Setter.prototype.composePrism=function(ab){return this.compose(ab.asSetter())},Setter.prototype.composeIso=function(ab){return this.compose(ab.asSetter())},Setter}();var seenKeys={},MULTIPLIER=Math.pow(2,24);function generateId(){for(var key;void 0===key||seenKeys.hasOwnProperty(key)||!isNaN(Number(key));)key=Math.floor(Math.random()*MULTIPLIER).toString(32);return seenKeys[key]=!0,key}var _excluded$2=["_modId"],getModifier=function(nodesAccessor,nodesSetter){return function(root){var f,TraversalModifier=function(){function TraversalModifier(tree,traversal){this.tree=tree,this.traversal=traversal}var _proto=TraversalModifier.prototype;return _proto.filter=function(predicate){return new TraversalModifier(this.tree,this.traversal.composePrism(Prism.fromPredicate(predicate)))},_proto.set=function(setter){return pipe$1(this.traversal.asFold().getAll(this.tree),map$5((function(node){return node._modId})),foldTree(this.tree,setter))},TraversalModifier}(),toArray=function(node){return Array.isArray(node)?node:of$2(node)},foldTree=function(tree,setter){return function(idsToSet){return(f=function(root,forest){return _extends({},root,nodesSetter(forest.reduce((function(modifiedForest,node){return pipe$1(node,function(idsToSet,setter){return function(modTreeNode){var _modId=modTreeNode._modId,node=_objectWithoutPropertiesLoose(modTreeNode,_excluded$2);return idsToSet.includes(_modId)?setter(node):node}}(idsToSet,setter),toArray,(prefix=modifiedForest,function(suffix){return[].concat(prefix,suffix)}));var prefix}),[])))},go=function(tree){return f(tree.value,tree.forest.map(go))})(tree);var f,go}};return new TraversalModifier(unfoldTree(root,(function(node){return[_extends({},node,{_modId:generateId()}),nodesAccessor(node)]})),(f=fromTraversable$1(tree),function(){return fromTraversal(f())})())}},nodesAccessor=function(node){return node.nodes},nodesSetter=function(nodes){return{nodes:nodes}},getRootNode=function(content){return{id:"root",type:"UNRECOGNIZED",nodes:content.nodes}},modify$1=function(content){return pipe$1(content,getRootNode,getModifier(nodesAccessor,nodesSetter),function(content){return function(modifier){var self={modifier:modifier};return{filter:function(predicate){return self.modifier=modifier.filter.bind(self.modifier)(predicate),self.modifier.set=this.set,self.modifier.filter=this.filter,self.modifier},set:function(setter){var root=modifier.set.bind(self.modifier)(setter);return _extends({},content,{nodes:root.nodes})}}}}(content))},isIndexFound=function(predicate){return flow((function(content){return content.nodes}),findIndex(predicate),fold$2((function(){return!1}),(function(){return!0})))},isIndexInRange=function(index){return function(content){return isNumber(index)&&index>=0&&index<content.nodes.length}},insertNode=function(node,index){return function(content){return _extends({},content,{nodes:[].concat(content.nodes.slice(0,index),[node],content.nodes.slice(index))})}},insertNodeByKey=function(node,nodeKey,isAfter){return void 0===isAfter&&(isAfter=!1),function(content){return modify$1(content).filter((function(_ref){return _ref.id===nodeKey})).set((function(n){return isAfter?[n,node]:[node,n]}))}};function addNode$1(_ref2){var node=_ref2.node,index=_ref2.index,before=_ref2.before,after=_ref2.after,content=_ref2.content;return firstRight(content,_extends({},content,{nodes:[].concat(content.nodes,[node])}),[[isIndexInRange(index),insertNode(node,index)],[isIndexFound((function(_ref3){return _ref3.id===before})),insertNodeByKey(node,before,!1)],[isIndexFound((function(_ref4){return _ref4.id===after})),insertNodeByKey(node,after,!0)]])}var isTextData=function(text){return!(null==text||!text.text||null==text||!text.decorations)},toTextData=function(text){return{text:text,decorations:[]}},isListItemData=function(item){return isArray(item.text)&&isObject(item.data)},toListItemData=function(data){return function(text){return{data:data,text:text}}},emptyListItemData={text:[],data:{}},dataByNodeType=function(type,data){var _CODE_BLOCK$DIVIDER$H;return(_CODE_BLOCK$DIVIDER$H={},_CODE_BLOCK$DIVIDER$H.CODE_BLOCK={codeBlockData:data},_CODE_BLOCK$DIVIDER$H.DIVIDER={dividerData:data},_CODE_BLOCK$DIVIDER$H.HEADING={headingData:data},_CODE_BLOCK$DIVIDER$H.FILE={fileData:data},_CODE_BLOCK$DIVIDER$H.GALLERY={galleryData:data},_CODE_BLOCK$DIVIDER$H.GIF={gifData:data},_CODE_BLOCK$DIVIDER$H.HTML={htmlData:data},_CODE_BLOCK$DIVIDER$H.IMAGE={imageData:data},_CODE_BLOCK$DIVIDER$H.BUTTON={buttonData:data},_CODE_BLOCK$DIVIDER$H.LINK_PREVIEW={LinkPreviewData:data},_CODE_BLOCK$DIVIDER$H.MAP={mapData:data},_CODE_BLOCK$DIVIDER$H.PARAGRAPH={paragraphData:data},_CODE_BLOCK$DIVIDER$H.POLL={pollData:data},_CODE_BLOCK$DIVIDER$H.TEXT={textData:data},_CODE_BLOCK$DIVIDER$H.VIDEO={videoData:data},_CODE_BLOCK$DIVIDER$H.APP_EMBED={appEmbedData:data},_CODE_BLOCK$DIVIDER$H.LINK_PREVIEW={linkPreviewData:data},_CODE_BLOCK$DIVIDER$H.TABLE={tableData:data},_CODE_BLOCK$DIVIDER$H.TABLE_CELL={tableCellData:data},_CODE_BLOCK$DIVIDER$H.COLLAPSIBLE_LIST={collapsibleListData:data},_CODE_BLOCK$DIVIDER$H)[type]},DEFAULT_PARAGRAPH_DATA={textStyle:{textAlignment:"AUTO"},indentation:0},DEFAULT_CONTAINER_DATA={alignment:"CENTER",textWrap:!0,width:{size:"CONTENT"}},DEFAULT_DIVIDER_DATA={lineStyle:"SINGLE",width:"LARGE",alignment:"CENTER",containerData:_extends({},DEFAULT_CONTAINER_DATA,{textWrap:!1})},DEFAULT_BUTTON_DATA={type:"ACTION",containerData:DEFAULT_CONTAINER_DATA,text:"Click Me"},DEFAULT_CODE_DATA={textStyle:{textAlignment:"AUTO"}},DEFAULT_HEADING_DATA={level:2,indentation:0,textStyle:{textAlignment:"AUTO"}},DEFAULT_MAP_DATA={containerData:DEFAULT_CONTAINER_DATA,mapSettings:{mapType:"ROADMAP"}},DEFAULT_HTML_DATA={containerData:DEFAULT_CONTAINER_DATA,html:"<div/>",url:void 0},DEFAULT_POLL_DATA={containerData:DEFAULT_CONTAINER_DATA,poll:{options:[],title:"",settings:{permissions:{view:"VOTERS",vote:"SITE_MEMBERS",allowMultipleVotes:!1},showVoters:!0,showVotesCount:!0}},layout:{poll:{type:"LIST",direction:"LTR",enableImage:!1},options:{enableImage:!1}},design:{poll:{background:{type:"IMAGE"},borderRadius:0},options:{borderRadius:0}}},createNode=function(generateId){return function(type,data,nodes){return _extends({id:generateId(),type:type},dataByNodeType(type,data),{nodes:nodes||[]})}},createTextNode=function(generateId){return function(type,text,data){return _extends({},createNode(generateId)(type,data),{nodes:text.map((function(textData){return _extends({nodes:[],id:"",type:"TEXT"},dataByNodeType("TEXT",textData))}))})}},addTextNode=function(generateId){return function(_ref3){var text=_ref3.text,data=_ref3.data,type=_ref3.type,index=_ref3.index,before=_ref3.before,after=_ref3.after,content=_ref3.content,textData=function(text){return firstRight(text,[],[[isString,flow(toTextData,of$2)],[isTextData,function(t){return[t]}],[isArray,flow(map$5((function(t){return firstRight(t,t,[[isString,toTextData]])})))]])}(text);return addNode$1({node:createTextNode(generateId)(type,textData,data),index:index,before:before,after:after,content:content})}},addListNode=function(generateId){return function(_ref4){var items=_ref4.items,_ref4$data=_ref4.data,data=void 0===_ref4$data?DEFAULT_PARAGRAPH_DATA:_ref4$data,type=_ref4.type,index=_ref4.index,before=_ref4.before,after=_ref4.after,content=_ref4.content,listItemData=function(items,data){return firstRight(items,[],[[isString,flow(toTextData,of$2,toListItemData(data),of$2)],[isTextData,flow(of$2,toListItemData(data),of$2)],[isListItemData,function(i){return[i]}],[isArray,flow(map$5((function(item){return firstRight(item,emptyListItemData,[[isString,flow(toTextData,of$2,toListItemData(data))],[isTextData,flow(of$2,toListItemData(data))],[isListItemData,function(i){return i}]])})))]])}(items,data);return addNode$1({node:function(generateId){return function(type,items){return createNode(generateId)(type,{},items.map((function(_ref){var text=_ref.text,data=_ref.data;return createNode(generateId)("LIST_ITEM",{},[createTextNode(generateId)("PARAGRAPH",text,data)])})))}}(generateId)(type,listItemData),index:index,before:before,after:after,content:content})}},DEFAULT_COLLAPSIBLE_LIST_DATA={initialExpandedItems:"FIRST",direction:"LTR",containerData:DEFAULT_CONTAINER_DATA,expandOnlyOne:!1},addCollapsibleList=function(generateId){return function(_ref){var args,items=_ref.items,data=_ref.data,index=_ref.index,before=_ref.before,after=_ref.after,content=_ref.content;return pipe$1(items,map$5(function(generateId){return function(item){return createNode(generateId)("COLLAPSIBLE_ITEM",{},[createNode(generateId)("COLLAPSIBLE_ITEM_TITLE",{},item.title.nodes),createNode(generateId)("COLLAPSIBLE_ITEM_BODY",{},item.content.nodes)])}}(generateId)),function(generateId){return function(data){return void 0===data&&(data=DEFAULT_COLLAPSIBLE_LIST_DATA),function(nodes){return createNode(generateId)("COLLAPSIBLE_LIST",data,nodes)}}}(generateId)(data),(args={index:index,before:before,after:after,content:content},function(node){return addNode$1(_extends({},args,{node:node}))}))}},DEFAULT_CELL_DATA={cellStyle:{verticalAlignment:"TOP"},borderColors:{}},DEFAULT_LAYOUT_DIMS_colsMinWidth=120,DEFAULT_LAYOUT_DIMS_rowsHeight=47,DEFAULT_LAYOUT_DIMS_colsWidthRatio=10,toRowNode=function(generateId){return function(row){return createNode(generateId)("TABLE_ROW",{},row.map(function(generateId){return function(cell){return createNode(generateId)("TABLE_CELL",cell.data||DEFAULT_CELL_DATA,cell.content.nodes)}}(generateId)))}},getMaxRowLength=function(rows){return Math.max.apply(Math,rows.map((function(r){return r.length})))},calcTableDims=function(rows){return[rows.length,rows.length>0?rows[0].nodes.length:0]},toPaddedRowNodes=function(generateId){return function(cells){return pipe$1(cells,getMaxRowLength,(rows=cells,emptyCell=function(generateId){return{content:{nodes:[createTextNode(generateId)("PARAGRAPH",[{text:"",decorations:[]}],DEFAULT_PARAGRAPH_DATA)]}}}(generateId),function(maxLen){return rows.map((function(r){return r.concat(Array(maxLen-r.length).fill(emptyCell))}))}),map$5(toRowNode(generateId)));var rows,emptyCell}},addTable=function(generateId){return function(_ref2){var args,cells=_ref2.cells,data=_ref2.data,index=_ref2.index,before=_ref2.before,after=_ref2.after,content=_ref2.content;return pipe$1(cells,toPaddedRowNodes(generateId),function(data){return function(rows){return[rows,data||(dims=calcTableDims(rows),{containerData:DEFAULT_CONTAINER_DATA,dimensions:{colsMinWidth:Array(dims[1]).fill(DEFAULT_LAYOUT_DIMS_colsMinWidth),colsWidthRatio:Array(dims[1]).fill(DEFAULT_LAYOUT_DIMS_colsWidthRatio),rowsHeight:Array(dims[0]).fill(DEFAULT_LAYOUT_DIMS_rowsHeight)}})];var dims}}(data),function(generateId){return function(_ref){var rows=_ref[0],data=_ref[1];return createNode(generateId)("TABLE",data,rows)}}(generateId),(args={index:index,before:before,after:after,content:content},function(node){return addNode$1(_extends({},args,{node:node}))}))}},setupContentBuilder=function(generateId){var RicosContentBuilder=function(){},builderApis={};return[{name:"addParagraph",type:"PARAGRAPH",dataT:DEFAULT_PARAGRAPH_DATA},{name:"addHeading",type:"HEADING",dataT:DEFAULT_HEADING_DATA},{name:"addCode",type:"CODE_BLOCK",dataT:DEFAULT_CODE_DATA}].forEach((function(_ref){var name=_ref.name,type=_ref.type,dataT=_ref.dataT;builderApis[name]=RicosContentBuilder.prototype[name]=function(_ref2){var _ref2$data=_ref2.data,data=void 0===_ref2$data?dataT:_ref2$data,text=_ref2.text,index=_ref2.index,before=_ref2.before,after=_ref2.after,content=_ref2.content;return addTextNode(generateId)({text:text,type:type,data:data,content:content,index:index,before:before,after:after})}})),[{name:"addBulletList",type:"BULLETED_LIST"},{name:"addOrderedList",type:"ORDERED_LIST"}].forEach((function(_ref3){var name=_ref3.name,type=_ref3.type;builderApis[name]=RicosContentBuilder.prototype[name]=function(_ref4){var items=_ref4.items,data=_ref4.data,index=_ref4.index,before=_ref4.before,after=_ref4.after,content=_ref4.content;return addListNode(generateId)({items:items,data:data,type:type,index:index,before:before,after:after,content:content})}})),[{name:"addDivider",type:"DIVIDER",dataT:DEFAULT_DIVIDER_DATA},{name:"addFile",type:"FILE",dataT:{}},{name:"addGallery",type:"GALLERY",dataT:{}},{name:"addHtml",type:"HTML",dataT:DEFAULT_HTML_DATA},{name:"addImage",type:"IMAGE",dataT:{}},{name:"addVideo",type:"VIDEO",dataT:{}},{name:"addAppEmbed",type:"APP_EMBED",dataT:{}},{name:"addEmbed",type:"EMBED",dataT:{}},{name:"addLinkPreview",type:"LINK_PREVIEW",dataT:{}},{name:"addButton",type:"BUTTON",dataT:DEFAULT_BUTTON_DATA},{name:"addGif",type:"GIF",dataT:{}},{name:"addMap",type:"MAP",dataT:DEFAULT_MAP_DATA},{name:"addPoll",type:"POLL",dataT:DEFAULT_POLL_DATA}].forEach((function(_ref5){var name=_ref5.name,type=_ref5.type,dataT=_ref5.dataT;builderApis[name]=RicosContentBuilder.prototype[name]=function(_ref6){var _ref6$data=_ref6.data,data=void 0===_ref6$data?dataT:_ref6$data,index=_ref6.index,before=_ref6.before,after=_ref6.after,content=_ref6.content;return function(generateId){return function(_ref2){var data=_ref2.data,type=_ref2.type,index=_ref2.index,before=_ref2.before,after=_ref2.after,content=_ref2.content;return addNode$1({node:createNode(generateId)(type,data),index:index,before:before,after:after,content:content})}}(generateId)({type:type,data:data,content:content,index:index,before:before,after:after})}})),Object.entries({addTable:addTable,addCollapsibleList:addCollapsibleList}).forEach((function(_ref7){var name=_ref7[0],method=_ref7[1];return builderApis[name]=RicosContentBuilder.prototype[name]=method(generateId)})),_extends({RicosContentBuilder:RicosContentBuilder},builderApis)},applyContent=function(content){return function(params){return _extends({},params,{content:content})}},_excluded$1=["data"],imageElementRegex=/^wix:image:\/\/v1\/(.+)\/(.+)#originWidth=(\d+)&originHeight=(\d+)/i,urlRegex=/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w.-]+)+[\w\-._~:/?#[\]@!$&'()*+,;=.]+$/g;function isImageElement(data){return!!data&&!isString(data)&&!!Object.keys(data).includes("src")}var asPublicUrl=function(data){return{image:{src:{url:data}}}},asImageElement=function(data){if(data.src.match(urlRegex))return{image:{src:{url:data.src}}};var _parseImageElement=function(data){var vars=imageElementRegex.exec(data.src);if("string"!=typeof data.src||null===vars)throw new Error("Source format is invalid. Received:\n"+JSON.stringify(data));var alt=data.alt,uri=vars[1],fileName=vars[2],originWidth=vars[3],originHeight=vars[4];return{uri:uri,fileName:fileName,width:parseInt(originWidth),height:parseInt(originHeight),alt:alt}}(data),width=_parseImageElement.width,height=_parseImageElement.height,id=_parseImageElement.uri;return{altText:_parseImageElement.alt,image:{src:{id:id},width:width,height:height}}},toImageData=function(data){return firstRight(data,data,[[isString,asPublicUrl],[isImageElement,asImageElement]])},addImage=function(_temp){var _ref=void 0===_temp?{}:_temp,data=_ref.data,rest=_objectWithoutPropertiesLoose(_ref,_excluded$1);return _extends({data:toImageData(data)},rest)},_excluded=["RicosContentBuilder"],extractBuilderMethods=function(_ref){return _ref.RicosContentBuilder,_objectWithoutPropertiesLoose(_ref,_excluded)},notify=function(content,callback){return null==callback||callback(content),createBuilder(content,callback)},createBuilder=function(content,callback){var originalMethods=pipe$1(generateId,setupContentBuilder,extractBuilderMethods),adapterMethods=pipe$1(originalMethods,function(content,callback){return function(methods){return Object.entries(methods).reduce((function(prev,_ref2){var _extends2,key=_ref2[0],func=_ref2[1];return _extends({},prev,((_extends2={})[key]=flow$1(applyContent(content),func,(function(newContent){return notify(newContent,callback)})),_extends2))}),{})}}(content,callback));return _extends({},adapterMethods,{addImage:flow$1(addImage,applyContent(content),originalMethods.addImage,(function(newContent){return notify(newContent,callback)})),get:function(){return content}})},modify=function(content,onSet){return pipe$1(content,modify$1,function(onSet,content){return function(modifier){var self={modifier:modifier};return{filter:function(predicate){return self.modifier=modifier.filter.bind(self.modifier)(predicate),self.modifier.set=this.set,self.modifier},set:function(setter){var root=modifier.set.bind(self.modifier)(setter),modifiedContent=_extends({},content,{nodes:root.nodes});return onSet(modifiedContent),modifiedContent}}}}(onSet,content))};export{createBuilder,modify};
