"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var lodash=require("lodash"),defaultEntityConverter=function(){return[]},videoConverter=function(_ref3){var _src$thumbnail,_ref3$data=_ref3.data,_ref3$data$src=_ref3$data.src,src=void 0===_ref3$data$src?{}:_ref3$data$src,isCustomVideo=_ref3$data.isCustomVideo,_ref3$data$metadata=_ref3$data.metadata,metadata=void 0===_ref3$data$metadata?{}:_ref3$data$metadata;return[{type:"video",url:lodash.isString(src)?src:src.pathname,isCustom:isCustomVideo,thumbnail:lodash.has(src,"thumbnail")?null===(_src$thumbnail=src.thumbnail)||void 0===_src$thumbnail?void 0:_src$thumbnail.pathname:metadata.thumbnail_url||"",caption:metadata.title||""}]},linkConverter=function(entity){return[{type:"link",url:entity.data.url}]},converters={"wix-draft-plugin-image":function(entity){var _entity$data$src,_entity$data$src2,_entity$data$src3,_entity$data$metadata,_entity$data$metadata2,_entity$data$config;return[{width:null===(_entity$data$src=entity.data.src)||void 0===_entity$data$src?void 0:_entity$data$src.width,height:null===(_entity$data$src2=entity.data.src)||void 0===_entity$data$src2?void 0:_entity$data$src2.height,url:null===(_entity$data$src3=entity.data.src)||void 0===_entity$data$src3?void 0:_entity$data$src3.file_name,type:"image",alt:(null===(_entity$data$metadata=entity.data.metadata)||void 0===_entity$data$metadata?void 0:_entity$data$metadata.alt)||"",caption:(null===(_entity$data$metadata2=entity.data.metadata)||void 0===_entity$data$metadata2?void 0:_entity$data$metadata2.caption)||"",link:null===(_entity$data$config=entity.data.config)||void 0===_entity$data$config?void 0:_entity$data$config.link}]},"wix-draft-plugin-gallery":function(entity){return entity.data.items.filter((function(_ref){var metadata=_ref.metadata;return!(null!=metadata&&metadata.type)||"image"===(null==metadata?void 0:metadata.type)||"video"===(null==metadata?void 0:metadata.type)})).map((function(_ref2){var _metadata$poster,metadata=_ref2.metadata,url=_ref2.url,itemId=_ref2.itemId;return"video"===(null==metadata?void 0:metadata.type)?{type:"video",url:url,thumbnail:(null==metadata||null===(_metadata$poster=metadata.poster)||void 0===_metadata$poster?void 0:_metadata$poster.url)||"",caption:(null==metadata?void 0:metadata.title)||"",isGalleryItem:!0}:{url:url,height:null==metadata?void 0:metadata.height,width:null==metadata?void 0:metadata.width,id:itemId,type:"image",alt:(null==metadata?void 0:metadata.altText)||"",caption:(null==metadata?void 0:metadata.title)||"",isGalleryItem:!0}}))},"wix-draft-plugin-divider":defaultEntityConverter,"wix-draft-plugin-video":videoConverter,"wix-draft-plugin-sound-cloud":videoConverter,"wix-draft-plugin-giphy":function(entity){var _entity$data$gif,_entity$data$gif2,_entity$data$gif3,_entity$data$gif4,_entity$data$gif5;return[{type:"giphy",url:null===(_entity$data$gif=entity.data.gif)||void 0===_entity$data$gif?void 0:_entity$data$gif.originalUrl,mp4:null===(_entity$data$gif2=entity.data.gif)||void 0===_entity$data$gif2?void 0:_entity$data$gif2.downsizedSmallMp4,thumbnail:null===(_entity$data$gif3=entity.data.gif)||void 0===_entity$data$gif3?void 0:_entity$data$gif3.stillUrl,width:null===(_entity$data$gif4=entity.data.gif)||void 0===_entity$data$gif4?void 0:_entity$data$gif4.width,height:null===(_entity$data$gif5=entity.data.gif)||void 0===_entity$data$gif5?void 0:_entity$data$gif5.height,source:"static"}]},"wix-draft-plugin-file-upload":function(entity){return[{name:entity.data.name,type:"file",fileType:entity.data.type,url:entity.data.url}]},"wix-draft-plugin-map":function(entity){return[{type:"map",mapSettings:entity.data.mapSettings}]},mention:defaultEntityConverter,"wix-draft-plugin-headers-markdown":defaultEntityConverter,"wix-draft-plugin-link-button":defaultEntityConverter,"wix-draft-plugin-action-button":defaultEntityConverter,"wix-draft-plugin-poll":defaultEntityConverter,LINK:linkConverter,LINK_PREVIEW:linkConverter,"wix-draft-plugin-html":defaultEntityConverter},toSeoImage=function(entityData){var _entityData$url=entityData.url,url=void 0===_entityData$url?"":_entityData$url,width=entityData.width,height=entityData.height,_entityData$alt=entityData.alt,alt=void 0===_entityData$alt?"":_entityData$alt,_entityData$caption=entityData.caption,caption=void 0===_entityData$caption?"":_entityData$caption;return{imageUrl:url?"https://static.wixstatic.com/media/"+url.replace("media/",""):"",imageWidth:width,imageHeight:height,imageAlt:alt,imageCaption:caption}},toSeoVideo=function(entityData){var _entityData$url2=entityData.url,url=void 0===_entityData$url2?"":_entityData$url2,_entityData$thumbnail=entityData.thumbnail,thumbnail=void 0===_entityData$thumbnail?"":_entityData$thumbnail,_entityData$caption2=entityData.caption,caption=void 0===_entityData$caption2?"":_entityData$caption2;return{videoThumbnailUrl:thumbnail.startsWith("media/")?"https://static.wixstatic.com/"+thumbnail:thumbnail,videoContentUrl:url.startsWith("video/")?"https://video.wixstatic.com/"+url:url,videoName:caption}},gifToSeoVideo=function(entityData){var _entityData$mp=entityData.mp4,videoContentUrl=void 0===_entityData$mp?"":_entityData$mp,_entityData$thumbnail2=entityData.thumbnail;return{videoThumbnailUrl:void 0===_entityData$thumbnail2?"":_entityData$thumbnail2,videoContentUrl:videoContentUrl,videoName:""}};exports.extractMedia=function(_ref){var entityMap=_ref.entityMap;return Object.values(entityMap).filter((function(entity){return["wix-draft-plugin-image","wix-draft-plugin-giphy","wix-draft-plugin-gallery","wix-draft-plugin-video"].includes(entity.type)})).reduce((function(media,entity){return[].concat(media,function(entity){return converters[entity.type]?converters[entity.type](entity):[]}(entity))}),[]).map((function(entityData){return{image:toSeoImage,video:toSeoVideo,giphy:gifToSeoVideo}[entityData.type](entityData)}))};
