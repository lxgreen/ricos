"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=require("@babel/runtime/helpers/extends"),_objectWithoutPropertiesLoose=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),lodash=require("lodash"),uuid=require("uuid");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var _RICOS_NODE_TYPE_TO_D,_INLINE_HEADER_TO_BLO,_extends__default=_interopDefaultLegacy(_extends),_objectWithoutPropertiesLoose__default=_interopDefaultLegacy(_objectWithoutPropertiesLoose),packageInfo_version="8.63.7",toVersion=function(versionString){return versionString.split(".").map((function(literal){var numeric=parseInt(literal,10);return lodash.isNaN(numeric)?0:numeric})).slice(0,3)},compareVersions=function(left,right){var leftVersion=toVersion(left),rightVersion=toVersion(right);return leftVersion.map((function(left,idx){return Math.sign(left-rightVersion[idx])})).find((function(num){return 0!==num}))||0},evaluations={"<":function(left,right){return compareVersions(left,right)<0},">":function(left,right){return compareVersions(left,right)>0},"=":function(left,right){return 0===compareVersions(left,right)},"<=":function(left,right){return compareVersions(left,right)<=0},">=":function(left,right){return compareVersions(left,right)>=0}},Version={lessThan:function(left,right){return compareVersions(left,right)<0},greaterThan:function(left,right){return compareVersions(left,right)>0},equal:function(left,right){return 0===compareVersions(left,right)},compare:compareVersions,currentVersion:packageInfo_version,evaluate:function(tested,semver){var _$exec=/([<>=]{0,2})(.*)/gm.exec(semver),operator=_$exec[1],version=_$exec[2];return evaluations[operator||"="](tested,version)}},HEADER_BLOCK=Object.freeze({ONE:"header-one",TWO:"header-two",THREE:"header-three",FOUR:"header-four",FIVE:"header-five",SIX:"header-six",PARAGRAPH:"unstyled"}),BLOCK_TYPES=Object.freeze(["header-one","header-two","header-three","header-four","header-five","header-six","unordered-list-item","ordered-list-item","blockquote","atomic","code-block","unstyled"]),GALLERY_TYPE="wix-draft-plugin-gallery",IMAGE_TYPE="wix-draft-plugin-image",VERTICAL_EMBED_TYPE="wix-draft-plugin-vertical-embed",VIDEO_TYPE="wix-draft-plugin-video",POLL_TYPE="wix-draft-plugin-poll",RICOS_NODE_TYPE_TO_DATA_FIELD=((_RICOS_NODE_TYPE_TO_D={}).BUTTON="buttonData",_RICOS_NODE_TYPE_TO_D.DIVIDER="dividerData",_RICOS_NODE_TYPE_TO_D.FILE="fileData",_RICOS_NODE_TYPE_TO_D.GALLERY="galleryData",_RICOS_NODE_TYPE_TO_D.GIF="gifData",_RICOS_NODE_TYPE_TO_D.HTML="htmlData",_RICOS_NODE_TYPE_TO_D.IMAGE="imageData",_RICOS_NODE_TYPE_TO_D.COLLAPSIBLE_LIST="collapsibleListData",_RICOS_NODE_TYPE_TO_D.LINK_PREVIEW="linkPreviewData",_RICOS_NODE_TYPE_TO_D.MAP="mapData",_RICOS_NODE_TYPE_TO_D.APP_EMBED="appEmbedData",_RICOS_NODE_TYPE_TO_D.VIDEO="videoData",_RICOS_NODE_TYPE_TO_D.POLL="pollData",_RICOS_NODE_TYPE_TO_D.TABLE="tableData",_RICOS_NODE_TYPE_TO_D.TABLE_CELL="tableCellData",_RICOS_NODE_TYPE_TO_D.PARAGRAPH="paragraphData",_RICOS_NODE_TYPE_TO_D.LIST_ITEM="paragraphData",_RICOS_NODE_TYPE_TO_D.HEADING="headingData",_RICOS_NODE_TYPE_TO_D.CODE_BLOCK="codeBlockData",_RICOS_NODE_TYPE_TO_D.BLOCKQUOTE="paragraphData",_RICOS_NODE_TYPE_TO_D.EMBED="embedData",_RICOS_NODE_TYPE_TO_D.EXTERNAL="externalData",_RICOS_NODE_TYPE_TO_D),INLINE_HEADER_ONE="inline-header-one",INLINE_HEADER_TWO="inline-header-two",INLINE_HEADER_THREE="inline-header-three",INLINE_HEADER_FOUR="inline-header-four",INLINE_HEADER_FIVE="inline-header-five",INLINE_HEADER_SIX="inline-header-six",INLINE_HEADERS=[INLINE_HEADER_THREE,INLINE_HEADER_TWO,INLINE_HEADER_ONE],INLINE_HEADER_TO_BLOCK=((_INLINE_HEADER_TO_BLO={})[INLINE_HEADER_ONE]=HEADER_BLOCK.ONE,_INLINE_HEADER_TO_BLO[INLINE_HEADER_TWO]=HEADER_BLOCK.TWO,_INLINE_HEADER_TO_BLO[INLINE_HEADER_THREE]=HEADER_BLOCK.THREE,_INLINE_HEADER_TO_BLO[INLINE_HEADER_FOUR]=HEADER_BLOCK.FOUR,_INLINE_HEADER_TO_BLO[INLINE_HEADER_FIVE]=HEADER_BLOCK.FIVE,_INLINE_HEADER_TO_BLO[INLINE_HEADER_SIX]=HEADER_BLOCK.SIX,_INLINE_HEADER_TO_BLO),removeInlineHeaderRanges=function(block){var inlineHeaderRanges=getInlineHeaderRanges(block.inlineStyleRanges||[]);return lodash.isEmpty(inlineHeaderRanges)?block:_extends__default.default({},block,{type:getBlockType(block.type,block.text,inlineHeaderRanges),inlineStyleRanges:omitInlineHeaderRanges(block.inlineStyleRanges||[])})},isInlineHeaderRange=function(range){return lodash.includes(INLINE_HEADERS,range.style)},omitInlineHeaderRanges=function(ranges){return ranges.filter(lodash.negate(isInlineHeaderRange))},getInlineHeaderRanges=function(ranges){return ranges.filter(isInlineHeaderRange)},getBlockType=function(type,text,inlineHeaderRanges){return"unstyled"===type&&shouldConvertToHeaderBlock(text,inlineHeaderRanges)?getBlockHeaderType(inlineHeaderRanges):type},shouldConvertToHeaderBlock=function(text,inlineStyleRanges){return 0===lodash.sortBy(inlineStyleRanges,"offset").map((function(range){return[range.offset,range.offset+range.length]})).reduce((function(ranges,range){var lastRange=lodash.last(ranges);return lastRange&&isOverlapping(lastRange,range)?[].concat(lodash.initial(ranges),[mergeOverlappingRanges(lastRange,range)]):[].concat(ranges,[range])}),[]).reverse().reduce((function(text,range){return""+text.slice(0,range[0])+text.slice(range[1])}),text).replace(/\s/g,"").length},isInRange=function(number,range){return range[0]<=number&&number<=range[1]},isOverlapping=function(rangeA,rangeB){return rangeA&&rangeB&&(isInRange(rangeB[0],rangeA)||isInRange(rangeB[1],rangeA))},mergeOverlappingRanges=function(rangeA,rangeB){return[Math.min(rangeA[0],rangeB[0]),Math.max(rangeA[1],rangeB[1])]},getBlockHeaderType=function(inlineHeaderRanges){var smallestInlineHeader=lodash.intersection(INLINE_HEADERS,inlineHeaderRanges.map((function(range){return range.style})))[0];return INLINE_HEADER_TO_BLOCK[smallestInlineHeader]},addInlineStyleRanges=function(block){return _extends__default.default({},block,{inlineStyleRanges:block.inlineStyleRanges||[]})},regex$3=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,regex$2=/[\0-\x1F\x7F-\x9F]/,regex$1=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,regex=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/;function assign(obj){var sources=Array.prototype.slice.call(arguments,1);return sources.forEach((function(source){source&&Object.keys(source).forEach((function(key){obj[key]=source[key]}))})),obj}function _class(obj){return Object.prototype.toString.call(obj)}function isFunction(obj){return"[object Function]"===_class(obj)}function escapeRE(str){return str.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var defaultOptions={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};var defaultSchemas={"http:":{validate:function(text,pos,self){var tail=text.slice(pos);return self.re.http||(self.re.http=new RegExp("^\\/\\/"+self.re.src_auth+self.re.src_host_port_strict+self.re.src_path,"i")),self.re.http.test(tail)?tail.match(self.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(text,pos,self){var tail=text.slice(pos);return self.re.no_http||(self.re.no_http=new RegExp("^"+self.re.src_auth+"(?:localhost|(?:(?:"+self.re.src_domain+")\\.)+"+self.re.src_domain_root+")"+self.re.src_port+self.re.src_host_terminator+self.re.src_path,"i")),self.re.no_http.test(tail)?pos>=3&&":"===text[pos-3]||pos>=3&&"/"===text[pos-3]?0:tail.match(self.re.no_http)[0].length:0}},"mailto:":{validate:function(text,pos,self){var tail=text.slice(pos);return self.re.mailto||(self.re.mailto=new RegExp("^"+self.re.src_email_name+"@"+self.re.src_host_strict,"i")),self.re.mailto.test(tail)?tail.match(self.re.mailto)[0].length:0}}},tlds_default="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф".split("|");function compile(self){var re$1=self.re=function(opts){var re={};return re.src_Any=regex$3.source,re.src_Cc=regex$2.source,re.src_Z=regex$1.source,re.src_P=regex.source,re.src_ZPCc=[re.src_Z,re.src_P,re.src_Cc].join("|"),re.src_ZCc=[re.src_Z,re.src_Cc].join("|"),re.src_pseudo_letter="(?:(?![><｜]|"+re.src_ZPCc+")"+re.src_Any+")",re.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",re.src_auth="(?:(?:(?!"+re.src_ZCc+"|[@/\\[\\]()]).)+@)?",re.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",re.src_host_terminator="(?=$|[><｜]|"+re.src_ZPCc+")(?!-|_|:\\d|\\.-|\\.(?!$|"+re.src_ZPCc+"))",re.src_path="(?:[/?#](?:(?!"+re.src_ZCc+"|[><｜]|[()[\\]{}.,\"'?!\\-]).|\\[(?:(?!"+re.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+re.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+re.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+re.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+re.src_ZCc+"|[']).)+\\'|\\'(?="+re.src_pseudo_letter+"|[-]).|\\.{2,4}[a-zA-Z0-9%/]|\\.(?!"+re.src_ZCc+"|[.]).|"+(opts&&opts["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+"\\,(?!"+re.src_ZCc+").|\\!(?!"+re.src_ZCc+"|[!]).|\\?(?!"+re.src_ZCc+"|[?]).)+|\\/)?",re.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',re.src_xn="xn--[a-z0-9\\-]{1,59}",re.src_domain_root="(?:"+re.src_xn+"|"+re.src_pseudo_letter+"{1,63})",re.src_domain="(?:"+re.src_xn+"|(?:"+re.src_pseudo_letter+")|(?:"+re.src_pseudo_letter+"(?:-|"+re.src_pseudo_letter+"){0,61}"+re.src_pseudo_letter+"))",re.src_host="(?:(?:(?:(?:"+re.src_domain+")\\.)*"+re.src_domain+"))",re.tpl_host_fuzzy="(?:"+re.src_ip4+"|(?:(?:(?:"+re.src_domain+")\\.)+(?:%TLDS%)))",re.tpl_host_no_ip_fuzzy="(?:(?:(?:"+re.src_domain+")\\.)+(?:%TLDS%))",re.src_host_strict=re.src_host+re.src_host_terminator,re.tpl_host_fuzzy_strict=re.tpl_host_fuzzy+re.src_host_terminator,re.src_host_port_strict=re.src_host+re.src_port+re.src_host_terminator,re.tpl_host_port_fuzzy_strict=re.tpl_host_fuzzy+re.src_port+re.src_host_terminator,re.tpl_host_port_no_ip_fuzzy_strict=re.tpl_host_no_ip_fuzzy+re.src_port+re.src_host_terminator,re.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+re.src_ZPCc+"|>|$))",re.tpl_email_fuzzy='(^|[><｜]|"|\\(|'+re.src_ZCc+")("+re.src_email_name+"@"+re.tpl_host_fuzzy_strict+")",re.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+re.src_ZPCc+"))((?![$+<=>^`|｜])"+re.tpl_host_port_fuzzy_strict+re.src_path+")",re.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+re.src_ZPCc+"))((?![$+<=>^`|｜])"+re.tpl_host_port_no_ip_fuzzy_strict+re.src_path+")",re}(self.__opts__),tlds=self.__tlds__.slice();function untpl(tpl){return tpl.replace("%TLDS%",re$1.src_tlds)}self.onCompile(),self.__tlds_replaced__||tlds.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),tlds.push(re$1.src_xn),re$1.src_tlds=tlds.join("|"),re$1.email_fuzzy=RegExp(untpl(re$1.tpl_email_fuzzy),"i"),re$1.link_fuzzy=RegExp(untpl(re$1.tpl_link_fuzzy),"i"),re$1.link_no_ip_fuzzy=RegExp(untpl(re$1.tpl_link_no_ip_fuzzy),"i"),re$1.host_fuzzy_test=RegExp(untpl(re$1.tpl_host_fuzzy_test),"i");var aliases=[];function schemaError(name,val){throw new Error('(LinkifyIt) Invalid schema "'+name+'": '+val)}self.__compiled__={},Object.keys(self.__schemas__).forEach((function(name){var val=self.__schemas__[name];if(null!==val){var compiled={validate:null,link:null};if(self.__compiled__[name]=compiled,"[object Object]"===_class(val))return!function(obj){return"[object RegExp]"===_class(obj)}(val.validate)?isFunction(val.validate)?compiled.validate=val.validate:schemaError(name,val):compiled.validate=function(re){return function(text,pos){var tail=text.slice(pos);return re.test(tail)?tail.match(re)[0].length:0}}(val.validate),void(isFunction(val.normalize)?compiled.normalize=val.normalize:val.normalize?schemaError(name,val):compiled.normalize=function(match,self){self.normalize(match)});!function(obj){return"[object String]"===_class(obj)}(val)?schemaError(name,val):aliases.push(name)}})),aliases.forEach((function(alias){self.__compiled__[self.__schemas__[alias]]&&(self.__compiled__[alias].validate=self.__compiled__[self.__schemas__[alias]].validate,self.__compiled__[alias].normalize=self.__compiled__[self.__schemas__[alias]].normalize)})),self.__compiled__[""]={validate:null,normalize:function(match,self){self.normalize(match)}};var slist=Object.keys(self.__compiled__).filter((function(name){return name.length>0&&self.__compiled__[name]})).map(escapeRE).join("|");self.re.schema_test=RegExp("(^|(?!_)(?:[><｜]|"+re$1.src_ZPCc+"))("+slist+")","i"),self.re.schema_search=RegExp("(^|(?!_)(?:[><｜]|"+re$1.src_ZPCc+"))("+slist+")","ig"),self.re.pretest=RegExp("("+self.re.schema_test.source+")|("+self.re.host_fuzzy_test.source+")|@","i"),function(self){self.__index__=-1,self.__text_cache__=""}(self)}function Match(self,shift){var start=self.__index__,end=self.__last_index__,text=self.__text_cache__.slice(start,end);this.schema=self.__schema__.toLowerCase(),this.index=start+shift,this.lastIndex=end+shift,this.raw=text,this.text=text,this.url=text}function createMatch(self,shift){var match=new Match(self,shift);return self.__compiled__[match.schema].normalize(match,self),match}function LinkifyIt(schemas,options){if(!(this instanceof LinkifyIt))return new LinkifyIt(schemas,options);var obj;options||(obj=schemas,Object.keys(obj||{}).reduce((function(acc,k){return acc||defaultOptions.hasOwnProperty(k)}),!1)&&(options=schemas,schemas={})),this.__opts__=assign({},defaultOptions,options),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=assign({},defaultSchemas,schemas),this.__compiled__={},this.__tlds__=tlds_default,this.__tlds_replaced__=!1,this.re={},compile(this)}LinkifyIt.prototype.add=function(schema,definition){return this.__schemas__[schema]=definition,compile(this),this},LinkifyIt.prototype.set=function(options){return this.__opts__=assign(this.__opts__,options),this},LinkifyIt.prototype.test=function(text){if(this.__text_cache__=text,this.__index__=-1,!text.length)return!1;var m,ml,me,len,shift,next,re,tld_pos;if(this.re.schema_test.test(text))for((re=this.re.schema_search).lastIndex=0;null!==(m=re.exec(text));)if(len=this.testSchemaAt(text,m[2],re.lastIndex)){this.__schema__=m[2],this.__index__=m.index+m[1].length,this.__last_index__=m.index+m[0].length+len;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(tld_pos=text.search(this.re.host_fuzzy_test))>=0&&(this.__index__<0||tld_pos<this.__index__)&&null!==(ml=text.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(shift=ml.index+ml[1].length,(this.__index__<0||shift<this.__index__)&&(this.__schema__="",this.__index__=shift,this.__last_index__=ml.index+ml[0].length)),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&text.indexOf("@")>=0&&null!==(me=text.match(this.re.email_fuzzy))&&(shift=me.index+me[1].length,next=me.index+me[0].length,(this.__index__<0||shift<this.__index__||shift===this.__index__&&next>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=shift,this.__last_index__=next)),this.__index__>=0},LinkifyIt.prototype.pretest=function(text){return this.re.pretest.test(text)},LinkifyIt.prototype.testSchemaAt=function(text,schema,pos){return this.__compiled__[schema.toLowerCase()]?this.__compiled__[schema.toLowerCase()].validate(text,pos,this):0},LinkifyIt.prototype.match=function(text){var shift=0,result=[];this.__index__>=0&&this.__text_cache__===text&&(result.push(createMatch(this,shift)),shift=this.__last_index__);for(var tail=shift?text.slice(shift):text;this.test(tail);)result.push(createMatch(this,shift)),tail=tail.slice(this.__last_index__),shift+=this.__last_index__;return result.length?result:null},LinkifyIt.prototype.tlds=function(list,keepOld){return list=Array.isArray(list)?list:[list],keepOld?(this.__tlds__=this.__tlds__.concat(list).sort().filter((function(el,idx,arr){return el!==arr[idx-1]})).reverse(),compile(this),this):(this.__tlds__=list.slice(),this.__tlds_replaced__=!0,compile(this),this)},LinkifyIt.prototype.normalize=function(match){match.schema||(match.url="http://"+match.url),"mailto:"!==match.schema||/^mailto:/i.test(match.url)||(match.url="mailto:"+match.url)},LinkifyIt.prototype.onCompile=function(){};var _dataNormalizers,_configNormalization,_dataNormalization,MediaUploadErrorKey,linkify$1=LinkifyIt(),HttpUrlPattern=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i"),getUrlMatches=function(text){return linkify$1.match(text)||[]},startsWithHttps=function(url){return/^https:/.test(url)},linkify=function(contentState,_ref){var anchorTarget=_ref.anchorTarget,relValue=_ref.relValue,lastKey=Object.keys(contentState.entityMap).length>0?Math.max.apply(Math,Object.keys(contentState.entityMap).map((function(key){return parseInt(key,10)})))+1:0;return contentState.blocks.reduce((function(state,block){var text=block.text,linkEntries=getUrlMatches(text).filter((function(_ref2){var url=_ref2.text,start=_ref2.index,end=_ref2.lastIndex,alreadyHasEntity=hasEntityInRange(block,start,end),longEnough=url.length>=6;return!alreadyHasEntity&&longEnough})).map((function(_ref3,idx){var url=_ref3.text,start=_ref3.index,end=_ref3.lastIndex;return createEntity(lastKey+=idx,url,start,end,anchorTarget,relValue)}));return{blocks:[].concat(state.blocks,[_extends__default.default({},block,{entityRanges:[].concat(block.entityRanges,linkEntries.map((function(_ref4){return _ref4.entityRange})))})]),entityMap:_extends__default.default({},linkEntries.reduce((function(entityMap,_ref5){var mapEntry=_ref5.mapEntry;return _extends__default.default({},entityMap,mapEntry)}),state.entityMap))}}),{blocks:[],entityMap:_extends__default.default({},contentState.entityMap)})},hasEntityInRange=function(block,start,end){return block.entityRanges.some((function(_ref6){var offset=_ref6.offset,length=_ref6.length;return start<offset+length&&end>=offset}))},createEntity=function(entityKey,url,start,end,anchorTarget,relValue){var _mapEntry;return{entityRange:{offset:start,length:end-start,key:entityKey},mapEntry:((_mapEntry={})[entityKey]={type:"LINK",mutability:"MUTABLE",data:{url:url,target:anchorTarget,rel:relValue}},_mapEntry)}},imagesTypes=["wix-draft-plugin-image","IMAGE"],invalidInlineTypes=[].concat(imagesTypes,["wix-draft-plugin-gallery","wix-draft-plugin-html","wix-draft-plugin-video","wix-draft-plugin-giphy","wix-draft-plugin-file-upload"]),inlinePluginsRemover=function(_temp){var _ref2$imagesOnly=(void 0===_temp?{}:_temp).imagesOnly,imagesOnly=void 0!==_ref2$imagesOnly&&_ref2$imagesOnly;return function(contentState){var newBlocks=contentState.blocks.map((function(block){var _block$entityRanges=block.entityRanges,entityRanges=void 0===_block$entityRanges?[]:_block$entityRanges,filteredRanges=entityRanges;return"atomic"===block.type||(filteredRanges=function(entityRanges,entityMap,entitiesToRemove){return entityRanges.filter((function(entityRange){var key=entityRange.key,entityType=(entityMap[key]||{}).type;return-1===entitiesToRemove.indexOf(entityType)}))}(entityRanges,contentState.entityMap,imagesOnly?imagesTypes:invalidInlineTypes)),_extends__default.default({},block,{entityRanges:filteredRanges})}));return _extends__default.default({},contentState,{blocks:newBlocks})}},blockProcessingStrategies={atomic:[{processors:[function(block){return"atomic"===block.type?_extends__default.default({},block,{text:" "}):block}]}],unstyled:[{processors:[removeInlineHeaderRanges,addInlineStyleRanges]}],"ordered-list-item":[{processors:[removeInlineHeaderRanges,addInlineStyleRanges]}],"unordered-list-item":[{processors:[removeInlineHeaderRanges,addInlineStyleRanges]}],"code-block":[{processors:[removeInlineHeaderRanges,addInlineStyleRanges]}],"header-one":[{processors:[removeInlineHeaderRanges,addInlineStyleRanges]}],"header-two":[{processors:[removeInlineHeaderRanges,addInlineStyleRanges]}],"header-three":[{processors:[removeInlineHeaderRanges,addInlineStyleRanges]}],"header-four":[{processors:[removeInlineHeaderRanges,addInlineStyleRanges]}],"header-five":[{processors:[removeInlineHeaderRanges,addInlineStyleRanges]}],"header-six":[{processors:[removeInlineHeaderRanges,addInlineStyleRanges]}],blockquote:[{processors:[removeInlineHeaderRanges,addInlineStyleRanges]}]},entityRangeProcessingStrategies={LINK:[{version:"<3.4.7",processors:[function(block,range){var inlineStyleRange={offset:range.offset,length:range.length,style:"UNDERLINE"},inlineStyleRanges=lodash.uniqWith([].concat(block.inlineStyleRanges||[],[inlineStyleRange]),lodash.isEqual);return _extends__default.default({},block,{inlineStyleRanges:inlineStyleRanges})}]}]},isVersionCompatible=function(strategy,contentStateVersion){return!strategy.version||Version.evaluate(contentStateVersion,strategy.version)},applyStrategies=function(strategies,processed,version){for(var _len=arguments.length,args=new Array(_len>3?_len-3:0),_key=3;_key<_len;_key++)args[_key-3]=arguments[_key];if(!strategies)return processed;var processedUnit=processed;return strategies.filter((function(strategy){return isVersionCompatible(strategy,version)})).forEach((function(strategy){strategy.processors.reduce((function(unit,processor){return processedUnit=processor.apply(void 0,[unit].concat(args))}),processed)})),processedUnit},processContentState=function(contentState,config){var _contentState$VERSION=contentState.VERSION,contentStateVersion=void 0===_contentState$VERSION?"0.0.0":_contentState$VERSION,processedState=applyStrategies(function(config){var disableInlineImages=config.disableInlineImages,removeInvalidInlinePlugins=config.removeInvalidInlinePlugins,strategies=[{version:"<3.4.7",processors:[linkify]}];return disableInlineImages&&strategies.push({version:"<8.0.0",processors:[inlinePluginsRemover({imagesOnly:!0})]}),removeInvalidInlinePlugins&&strategies.push({version:"<8.0.0",processors:[inlinePluginsRemover()]}),strategies}(config),contentState,contentStateVersion,config),blocks=processedState.blocks,entityMap=processedState.entityMap,documentStyle=processedState.documentStyle;return{blocks:blocks.map((function(block){var processedBlock=block;return(processedBlock=applyStrategies(blockProcessingStrategies[block.type],block,contentStateVersion,entityMap,config)).entityRanges&&processedBlock.entityRanges.forEach((function(range){var entityType=entityMap&&entityMap[range.key+""]&&entityMap[range.key+""].type;entityType&&(processedBlock=applyStrategies(entityRangeProcessingStrategies[entityType],processedBlock,contentStateVersion,range,entityMap,config))})),processedBlock})),entityMap:entityMap,documentStyle:documentStyle,VERSION:Version.lessThan(contentStateVersion,Version.currentVersion)?Version.currentVersion:contentStateVersion}},_excluded$2=["width","config"],_excluded$1=["targetBlank","nofollow"],isUndefined=function(val){return void 0===val},isDefined=function(val){return!isUndefined(val)},normalizePoll=function(poll){var blackList=["anonymousCount","count","creatorFlag","ownVotes","latestVoters","rating"],normalizedPoll=lodash.omit(poll,blackList);return normalizedPoll.options=poll.options.map((function(option){return lodash.omit(option,blackList)})),normalizedPoll},_excluded=["anchor"],dataNormalizers=((_dataNormalizers={}).LINK=function(componentData,_ref2){var anchorTarget=_ref2.anchorTarget,relValue=_ref2.relValue,targetBlank=componentData.targetBlank,nofollow=componentData.nofollow,rest=_objectWithoutPropertiesLoose__default.default(componentData,_excluded$1);return function(_ref){var targetBlank=_ref.targetBlank,nofollow=_ref.nofollow,target=_ref.target,rel=_ref.rel;return isUndefined(targetBlank)&&isUndefined(nofollow)&&isDefined(target)&&isDefined(rel)}(componentData)?componentData:_extends__default.default({target:targetBlank?"_blank":anchorTarget,rel:nofollow?"nofollow":relValue},rest)},_dataNormalizers[IMAGE_TYPE]=function(componentData,normalizerConfig){var shouldNormalizeDisableDownload=void 0===componentData.disableDownload&&void 0!==normalizerConfig.disableDownload,shouldNormalizeExpand=void 0===componentData.disableExpand&&void 0!==normalizerConfig.disableImagesExpand;shouldNormalizeDisableDownload&&(componentData.disableDownload=normalizerConfig.disableDownload),shouldNormalizeExpand&&(componentData.disableExpand=normalizerConfig.disableImagesExpand);var width=componentData.width,_componentData$config=componentData.config,config=void 0===_componentData$config?{}:_componentData$config,rest=_objectWithoutPropertiesLoose__default.default(componentData,_excluded$2);return"inline"===config.size&&width&&!config.width?_extends__default.default({},rest,{config:_extends__default.default({},config,{width:width})}):componentData},_dataNormalizers[GALLERY_TYPE]=function(componentData,normalizerConfig,stateVersion){var shouldNormalizeDisableDownload=void 0===componentData.disableDownload&&void 0!==normalizerConfig.disableDownload,shouldNormalizeExpand=void 0===componentData.disableExpand&&void 0!==normalizerConfig.disableGalleryExpand;if(shouldNormalizeDisableDownload&&(componentData.disableDownload=normalizerConfig.disableDownload),shouldNormalizeExpand&&(componentData.disableExpand=normalizerConfig.disableGalleryExpand),Version.lessThan(stateVersion,"6")){var items=componentData.items.map((function(item){var metadata=item.metadata,altText=metadata.title;return altText&&(metadata.altText=altText),delete metadata.title,item}));componentData.items=items}return Version.lessThan(stateVersion,"8.49.0")&&componentData.styles.thumbnailSpacings&&(componentData.styles.thumbnailSpacings*=2),componentData},_dataNormalizers[VIDEO_TYPE]=function(componentData,normalizerConfig){return void 0===componentData.disableDownload&&normalizerConfig.disableDownload&&(componentData.disableDownload=!0),componentData},_dataNormalizers[VERTICAL_EMBED_TYPE]=function(componentData){var selectedProduct=componentData.selectedProduct,type=componentData.type,html=selectedProduct.html,description=selectedProduct.description;if(html){var _selectedProduct$html,_selectedProduct$html2,_selectedProduct$desc,_selectedProduct$desc2,pageUrl=null===(_selectedProduct$html=selectedProduct.html.match(/href="[^"]*/g))||void 0===_selectedProduct$html||null===(_selectedProduct$html2=_selectedProduct$html[0])||void 0===_selectedProduct$html2?void 0:_selectedProduct$html2.slice(6),additionalData={};if("event"===type)additionalData={scheduling:null===(_selectedProduct$desc=selectedProduct.description.match(/[^|]+/))||void 0===_selectedProduct$desc?void 0:_selectedProduct$desc[0],location:null===(_selectedProduct$desc2=selectedProduct.description.match(/[^|]*$/))||void 0===_selectedProduct$desc2?void 0:_selectedProduct$desc2[0]};else"booking"===type&&(additionalData={durations:description});return _extends__default.default({},componentData,{selectedProduct:_extends__default.default({},selectedProduct,additionalData,{pageUrl:pageUrl})})}return componentData},_dataNormalizers[POLL_TYPE]=function(componentData){return _extends__default.default({},lodash.omit(componentData,["siteToken","config.enableVoteRole"]),{poll:normalizePoll(componentData.poll)})},_dataNormalizers),normalizeComponentData=function(type,componentData,config,version){return dataNormalizers[type](componentData,config,version)},normalizeComponentConfig=function(componentData){if(componentData.config)return componentData;var config={},alignment=componentData.alignment,size=componentData.size,src=componentData.src,oembed=componentData.oembed;alignment?(delete componentData.alignment,config.alignment=alignment,config.size="small"):size?(delete componentData.size,"smallCenter"===size?(config.size="small",config.alignment="center"):"fullWidth"===size&&(config.size="fullWidth",config.alignment="center")):(config.size=src&&src.width&&src.width<=740?"original":"content",config.alignment="center");var patch={config:config};return oembed&&(delete componentData.url,delete componentData.oembed,patch.src=oembed.video_url,patch.metadata={oembed:oembed}),_extends__default.default({},componentData,patch)},entityTypeMap={configNormalization:(_configNormalization={},_configNormalization.IMAGE=IMAGE_TYPE,_configNormalization["VIDEO-EMBED"]=VIDEO_TYPE,_configNormalization),dataNormalization:(_dataNormalization={},_dataNormalization.LINK="LINK",_dataNormalization[IMAGE_TYPE]=IMAGE_TYPE,_dataNormalization[GALLERY_TYPE]=GALLERY_TYPE,_dataNormalization[VIDEO_TYPE]=VIDEO_TYPE,_dataNormalization[VERTICAL_EMBED_TYPE]=VERTICAL_EMBED_TYPE,_dataNormalization[POLL_TYPE]=POLL_TYPE,_dataNormalization)},shouldNormalizeEntity=function(entity,normalizationMap){return Object.keys(normalizationMap).includes(entity.type)&&entity.data},normalizeEntityMap=function(entityMap,config,stateVersion){var normalizeType=function(key,obj){return obj[key]||key};return lodash.mapValues(entityMap,(function(entity){var _newEntity,_newEntity$data,_newEntity2,_newEntity2$data,_newEntity2$data$conf,newEntity=entity;return!function(entity){return shouldNormalizeEntity(entity,entityTypeMap.configNormalization)}(entity)?function(entity){return shouldNormalizeEntity(entity,entityTypeMap.dataNormalization)}(entity)&&(newEntity=_extends__default.default({},entity,{type:normalizeType(entity.type,entityTypeMap.dataNormalization),data:normalizeComponentData(entity.type,entity.data,config,stateVersion)})):newEntity=_extends__default.default({},entity,{type:normalizeType(entity.type,entityTypeMap.configNormalization),data:normalizeComponentConfig(entity.data)}),null===(_newEntity=newEntity)||void 0===_newEntity||null===(_newEntity$data=_newEntity.data)||void 0===_newEntity$data||!_newEntity$data.config||null!==(_newEntity2=newEntity)&&void 0!==_newEntity2&&null!==(_newEntity2$data=_newEntity2.data)&&void 0!==_newEntity2$data&&null!==(_newEntity2$data$conf=_newEntity2$data.config)&&void 0!==_newEntity2$data$conf&&_newEntity2$data$conf.textWrap||(newEntity.data.config.textWrap="wrap"),convertAnchorToLinkToUndoOneAppFix(newEntity),newEntity}))},convertAnchorToLinkToUndoOneAppFix=function(newEntity){if("ANCHOR"===newEntity.type)newEntity.type="LINK";else if(function(entity){var _entity$data,_entity$data$config,_entity$data2,_entity$data2$config;return!("wix-draft-plugin-image"!==entity.type||null===(_entity$data=entity.data)||void 0===_entity$data||null===(_entity$data$config=_entity$data.config)||void 0===_entity$data$config||!_entity$data$config.anchor||null!==(_entity$data2=entity.data)&&void 0!==_entity$data2&&null!==(_entity$data2$config=_entity$data2.config)&&void 0!==_entity$data2$config&&_entity$data2$config.link)}(newEntity)){var _newEntity$data$confi=newEntity.data.config,anchor=_newEntity$data$confi.anchor,rest=_objectWithoutPropertiesLoose__default.default(_newEntity$data$confi,_excluded);newEntity.data=_extends__default.default({},newEntity.data,{config:_extends__default.default({},rest,{link:{anchor:anchor}})})}};exports.MediaUploadErrorKey=void 0,(MediaUploadErrorKey=exports.MediaUploadErrorKey||(exports.MediaUploadErrorKey={}))[MediaUploadErrorKey.GENERIC=0]="GENERIC",MediaUploadErrorKey[MediaUploadErrorKey.SIZE_LIMIT=1]="SIZE_LIMIT",MediaUploadErrorKey[MediaUploadErrorKey.QUOTA_STORAGE_VISITOR=2]="QUOTA_STORAGE_VISITOR",MediaUploadErrorKey[MediaUploadErrorKey.QUOTA_STORAGE_OWNER=3]="QUOTA_STORAGE_OWNER",MediaUploadErrorKey[MediaUploadErrorKey.QUOTA_VIDEO_VISITOR=4]="QUOTA_VIDEO_VISITOR",MediaUploadErrorKey[MediaUploadErrorKey.QUOTA_VIDEO_OWNER=5]="QUOTA_VIDEO_OWNER",MediaUploadErrorKey[MediaUploadErrorKey.QUOTA_SINGLE_VIDEO_VISITOR=6]="QUOTA_SINGLE_VIDEO_VISITOR",MediaUploadErrorKey[MediaUploadErrorKey.QUOTA_SINGLE_VIDEO_OWNER=7]="QUOTA_SINGLE_VIDEO_OWNER",MediaUploadErrorKey[MediaUploadErrorKey.MIME_TYPE_MISMATCH=8]="MIME_TYPE_MISMATCH",MediaUploadErrorKey[MediaUploadErrorKey.WMP_ERROR_GENERAL=9]="WMP_ERROR_GENERAL",MediaUploadErrorKey[MediaUploadErrorKey.INVALID_SESSION=10]="INVALID_SESSION",MediaUploadErrorKey[MediaUploadErrorKey.SESSION_EXPIRED=11]="SESSION_EXPIRED",MediaUploadErrorKey[MediaUploadErrorKey.MISSING_WIX_SESSION=12]="MISSING_WIX_SESSION",MediaUploadErrorKey[MediaUploadErrorKey.INCORRECT_FILE_INFO=13]="INCORRECT_FILE_INFO",MediaUploadErrorKey[MediaUploadErrorKey.CORRUPT_FILE=14]="CORRUPT_FILE",MediaUploadErrorKey[MediaUploadErrorKey.UNSUPPORTED_EXTENSION=15]="UNSUPPORTED_EXTENSION",MediaUploadErrorKey[MediaUploadErrorKey.MISSING_HEADER=16]="MISSING_HEADER",MediaUploadErrorKey[MediaUploadErrorKey.FORMAT_CHUNK_MISSING=17]="FORMAT_CHUNK_MISSING",MediaUploadErrorKey[MediaUploadErrorKey.EXT_FILE_AUTHORIZATION=18]="EXT_FILE_AUTHORIZATION",MediaUploadErrorKey[MediaUploadErrorKey.EXT_FILE_FORBBIDEN=19]="EXT_FILE_FORBBIDEN",MediaUploadErrorKey[MediaUploadErrorKey.IMAGE_FORMAT=20]="IMAGE_FORMAT",MediaUploadErrorKey[MediaUploadErrorKey.CORRUPT_IMAGE=21]="CORRUPT_IMAGE",MediaUploadErrorKey[MediaUploadErrorKey.IMAGE_DIMENSIONS_EXCEEDED=22]="IMAGE_DIMENSIONS_EXCEEDED",MediaUploadErrorKey[MediaUploadErrorKey.MP4_STEREO_FORMAT=23]="MP4_STEREO_FORMAT",MediaUploadErrorKey[MediaUploadErrorKey.WAV_STEREO_FORMAT=24]="WAV_STEREO_FORMAT",MediaUploadErrorKey[MediaUploadErrorKey.WMA_BITRATE=25]="WMA_BITRATE",MediaUploadErrorKey[MediaUploadErrorKey.WMA_BITRATE_LOSSY=26]="WMA_BITRATE_LOSSY",MediaUploadErrorKey[MediaUploadErrorKey.MP4_BITRATE=27]="MP4_BITRATE",MediaUploadErrorKey[MediaUploadErrorKey.MP3_UNSUPPORTED_STEREO=28]="MP3_UNSUPPORTED_STEREO",MediaUploadErrorKey[MediaUploadErrorKey.MP3_UNSUPPORTED_FORMAT=29]="MP3_UNSUPPORTED_FORMAT",MediaUploadErrorKey[MediaUploadErrorKey.WAV_SAMPLE_RATE=30]="WAV_SAMPLE_RATE",MediaUploadErrorKey[MediaUploadErrorKey.AAC_UNSUPPORTED_FORMAT=31]="AAC_UNSUPPORTED_FORMAT",MediaUploadErrorKey[MediaUploadErrorKey.WAV_UNSUPPORTED_FORMAT=32]="WAV_UNSUPPORTED_FORMAT",MediaUploadErrorKey[MediaUploadErrorKey.WAV_SAMPLE_SIZE=33]="WAV_SAMPLE_SIZE",MediaUploadErrorKey[MediaUploadErrorKey.WAV_CHUNK_SIZE=34]="WAV_CHUNK_SIZE",MediaUploadErrorKey[MediaUploadErrorKey.AUDIO_CODEC=35]="AUDIO_CODEC",MediaUploadErrorKey[MediaUploadErrorKey.EMPTY_FILE=36]="EMPTY_FILE",MediaUploadErrorKey[MediaUploadErrorKey.MP4_UNSUPPORTED_FORMAT=37]="MP4_UNSUPPORTED_FORMAT",MediaUploadErrorKey[MediaUploadErrorKey.MP4_SAMPLE_RATE=38]="MP4_SAMPLE_RATE",MediaUploadErrorKey[MediaUploadErrorKey.VIDEO_BITRATE=39]="VIDEO_BITRATE",MediaUploadErrorKey[MediaUploadErrorKey.VIDEO_DURATION_MISMATCH=40]="VIDEO_DURATION_MISMATCH",MediaUploadErrorKey[MediaUploadErrorKey.VIDEO_CODEC=41]="VIDEO_CODEC";var seenKeys={},MULTIPLIER=Math.pow(2,24);var version=packageInfo_version,isobject$1=function(val){return null!=val&&"object"==typeof val&&!1===Array.isArray(val)};function isObjectObject(o){return!0===isobject$1(o)&&"[object Object]"===Object.prototype.toString.call(o)}var toString$1={}.toString,isarray=Array.isArray||function(arr){return"[object Array]"==toString$1.call(arr)},hasValues=function(o,noZero){if(null==o)return!1;if("boolean"==typeof o)return!0;if("number"==typeof o)return 0!==o||!0!==noZero;if(void 0!==o.length)return 0!==o.length;for(var key in o)if(o.hasOwnProperty(key))return!0;return!1};function toString(val){return val?Array.isArray(val)?val.join("."):val:""}var hasValue=function(obj,prop,noZero){return null!=(val=obj)&&"object"==typeof val&&!1===isarray(val)?hasValues(function(obj,prop,a,b,c){if(null===(val=obj)||"object"!=typeof val&&"function"!=typeof val||!prop)return obj;var val;if(prop=toString(prop),a&&(prop+="."+toString(a)),b&&(prop+="."+toString(b)),c&&(prop+="."+toString(c)),prop in obj)return obj[prop];for(var segs=prop.split("."),len=segs.length,i=-1;obj&&++i<len;){for(var key=segs[i];"\\"===key[key.length-1];)key=key.slice(0,-1)+"."+segs[++i];obj=obj[key]}return obj}(obj,prop),noZero):hasValues(obj,prop);var val},unsetValue=function(obj,prop){if(!isobject$1(obj))throw new TypeError("expected an object.");if(obj.hasOwnProperty(prop))return delete obj[prop],!0;if(hasValue(obj,prop)){for(var segs=prop.split("."),last=segs.pop();segs.length&&"\\"===segs[segs.length-1].slice(-1);)last=segs.pop().slice(0,-1)+"."+last;for(;segs.length;)obj=obj[prop=segs.shift()];return delete obj[last]}return!0},omitDeep=function omitDeep(value,keys){if(void 0===value)return{};if(Array.isArray(value)){for(var i=0;i<value.length;i++)value[i]=omitDeep(value[i],keys);return value}if(!1===isObjectObject(o=value)||"function"!=typeof(ctor=o.constructor)||!1===isObjectObject(prot=ctor.prototype)||!1===prot.hasOwnProperty("isPrototypeOf"))return value;var o,ctor,prot;if("string"==typeof keys&&(keys=[keys]),!Array.isArray(keys))return value;for(var j=0;j<keys.length;j++)unsetValue(value,keys[j]);for(var key in value)value.hasOwnProperty(key)&&(value[key]=omitDeep(value[key],keys));return value};var IGNORED_KEYS=["updatedTimestamp","createdTimestamp","tempData","isCustomVideo","VERSION"],IGNORED_POLL_CONFIG_KEYS=["alignment","size","width"],IGNORED_SRC_KEYS=["id","original_file_name"],IGNORED_BUTTON_DESIGN_KEYS=["activeButton","padding"],OEMBED_KEYS=["thumbnail_url","width","height"];var comparator=function(left,right,key){return void 0!==(null==left?void 0:left.enableVoteRole)||void 0!==(null==right?void 0:right.enableVoteRole)?lodash.isEqual(lodash.omit(left,IGNORED_POLL_CONFIG_KEYS),lodash.omit(right,IGNORED_POLL_CONFIG_KEYS)):null!=left&&left.thumbnail_url||null!=right&&right.thumbnail_url?lodash.isEqual(lodash.pick(left,OEMBED_KEYS),lodash.pick(right,OEMBED_KEYS)):"src"===key?lodash.isEqual(lodash.omit(left,IGNORED_SRC_KEYS),lodash.omit(right,IGNORED_SRC_KEYS)):"design"===key?lodash.isEqual(lodash.omit(left,IGNORED_BUTTON_DESIGN_KEYS),lodash.omit(right,IGNORED_BUTTON_DESIGN_KEYS)):"link"!==key||"noopener"!==(null==right?void 0:right.rel)&&"noopener"!==(null==left?void 0:left.rel)?void 0:lodash.isEqual(lodash.omit(left,["rel"]),lodash.omit(right,["rel"]))},removeEmoji=function(object){var iterable,emojiEntityKeys=[];Object.entries(object.entityMap).forEach((function(_ref){var key=_ref[0];return"EMOJI_TYPE"===_ref[1].type&&emojiEntityKeys.push(parseInt(key,10))})),object.entityMap=(iterable=Object.entries(object.entityMap).filter((function(_ref2){return"EMOJI_TYPE"!==_ref2[1].type})),[].concat(iterable).reduce((function(obj,_ref){var key=_ref[0],val=_ref[1];return obj[key]=val,obj}),{})),object.blocks=object.blocks.map((function(block){return _extends__default.default({},block,{entityRanges:block.entityRanges.filter((function(range){return!emojiEntityKeys.includes(range.key)}))})}))};function identity(a){return a}function pipe(a,ab,bc,cd,de,ef,fg,gh,hi,ij,jk,kl,lm,mn,no,op,pq,qr,rs,st){switch(arguments.length){case 1:return a;case 2:return ab(a);case 3:return bc(ab(a));case 4:return cd(bc(ab(a)));case 5:return de(cd(bc(ab(a))));case 6:return ef(de(cd(bc(ab(a)))));case 7:return fg(ef(de(cd(bc(ab(a))))));case 8:return gh(fg(ef(de(cd(bc(ab(a)))))));case 9:return hi(gh(fg(ef(de(cd(bc(ab(a))))))));case 10:return ij(hi(gh(fg(ef(de(cd(bc(ab(a)))))))));case 11:return jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a))))))))));case 12:return kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a)))))))))));case 13:return lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a))))))))))));case 14:return mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a)))))))))))));case 15:return no(mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a))))))))))))));case 16:return op(no(mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a)))))))))))))));case 17:return pq(op(no(mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a))))))))))))))));case 18:return qr(pq(op(no(mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a)))))))))))))))));case 19:return rs(qr(pq(op(no(mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a))))))))))))))))));case 20:return st(rs(qr(pq(op(no(mn(lm(kl(jk(ij(hi(gh(fg(ef(de(cd(bc(ab(a)))))))))))))))))))}}var left$1=function(e){return{_tag:"Left",left:e}},right$1=function(a){return{_tag:"Right",right:a}};function fromPredicate$1(F){return function(predicate,onFalse){return function(a){return F.fromEither(predicate(a)?right$1(a):left$1(onFalse(a)))}}}var concatAll$1=function(M){return function(startWith){return function(as){return as.reduce((function(a,acc){return M.concat(a,acc)}),startWith)}}},semigroupVoid=function(a){return{concat:function(){return a}}}(void 0),of=function(a){return[a]},map$1=function(f){return function(fa){return fa.map((function(a){return f(a)}))}},chain=function(f){return function(ma){return pipe(ma,function(f){return function(as){for(var out=[],i=0;i<as.length;i++)out.push.apply(out,f(i,as[i]));return out}}((function(_,a){return f(a)})))}},left=left$1,right=right$1,fromPredicate=fromPredicate$1({URI:"Either",fromEither:identity}),isLeft=function(ma){return"Left"===ma._tag},fold=function(onLeft,onRight){return function(ma){return isLeft(ma)?onLeft(ma.left):onRight(ma.right)}};semigroupVoid.concat;var MonoidAny={concat:function(first,second){return first||second},empty:!1},none={_tag:"None"},some=function(a){return{_tag:"Some",value:a}},fromNullable=function(a){return null==a?none:some(a)},concatApply=function(m){return function(fns){return function(data){return pipe(fns,(fa=of(data),chain((function(f){return pipe(fa,map$1(f))}))),concatAll$1(M=m)(M.empty));var M,fa}}},and=concatApply({concat:function(first,second){return first&&second},empty:!0}),or=concatApply(MonoidAny),tap=function(f){return function(data){return f(data),data}},a=_extends__default.default({},{yaron:"_2yEvr"});exports.ACTION_BUTTON_TYPE="wix-draft-plugin-action-button",exports.ANCHOR_TYPE="ANCHOR",exports.APP_EMBED_TYPE="wix-draft-plugin-vertical-embed",exports.BLOCKQUOTE="blockquote",exports.BLOCK_TYPES=BLOCK_TYPES,exports.BULLET_LIST_TYPE="unordered-list-item",exports.CODE_BLOCK_TYPE="code-block",exports.COLLAPSIBLE_LIST_TYPE="wix-rich-content-plugin-collapsible-list",exports.CUSTOM_LINK_TYPE="ricos-plugin-custom-link",exports.DEFAULT_HEADINGS=["h2","h3","h4","h5","h6"],exports.DEFAULT_TITLE_HEADINGS=["h2","h3"],exports.DIVIDER_TYPE="wix-draft-plugin-divider",exports.EMBED_TYPE="EMBED",exports.EMOJI_TYPE="wix-draft-plugin-emoji",exports.EXTERNAL="EXTERNAL",exports.EXTERNAL_LINK_TYPE="wix-draft-plugin-external-link",exports.EXTERNAL_MENTIONS_TYPE="wix-draft-plugin-external-mentions",exports.FILE_UPLOAD_TYPE="wix-draft-plugin-file-upload",exports.GALLERY_TYPE=GALLERY_TYPE,exports.GIPHY_TYPE="wix-draft-plugin-giphy",exports.HASHTAG_TYPE="wix-draft-plugin-hashtag",exports.HEADERS_MARKDOWN_TYPE="wix-draft-plugin-headers-markdown",exports.HEADER_BLOCK=HEADER_BLOCK,exports.HEADINGS_DROPDOWN_TYPE="wix-rich-content-plugin-headings",exports.HEADINGS_TYPE="headings",exports.HTML_TYPE="wix-draft-plugin-html",exports.IMAGE_TYPE=IMAGE_TYPE,exports.IMAGE_TYPE_LEGACY="IMAGE",exports.INDENT_TYPE="wix-rich-content-plugin-indent",exports.LINE_SPACING_TYPE="line-spacing",exports.LINK_BUTTON_TYPE="wix-draft-plugin-link-button",exports.LINK_PREVIEW_TYPE="wix-draft-plugin-link-preview",exports.LINK_TYPE="LINK",exports.MAP_TYPE="wix-draft-plugin-map",exports.MENTION_TYPE="mention",exports.NO_WRAP="nowrap",exports.NUMBERED_LIST_TYPE="ordered-list-item",exports.POLL_TYPE=POLL_TYPE,exports.PREVIEW="PREVIEW",exports.RICOS_ACTION_BUTTON_TYPE="ricos-action-button",exports.RICOS_ANCHOR_TYPE="ricos-anchor",exports.RICOS_BOLD_TYPE="ricos-bold",exports.RICOS_CODE_BLOCK_TYPE="ricos-code-block",exports.RICOS_COLLAPSIBLE_LIST_TYPE="ricos-collapsible-list",exports.RICOS_COLOR_TYPE="ricos-color",exports.RICOS_DIVIDER_TYPE="ricos-divider",exports.RICOS_EMOJI_TYPE="ricos-emoji",exports.RICOS_EXTERNAL_LINK_TYPE="ricos-external-link",exports.RICOS_EXTERNAL_MENTION_TYPE="ricos-external-mention",exports.RICOS_FILE_TYPE="ricos-file",exports.RICOS_FONT_SIZE_TYPE="ricos-font-size",exports.RICOS_GALLERY_TYPE="ricos-gallery",exports.RICOS_GIPHY_TYPE="ricos-giphy",exports.RICOS_HASHTAG_TYPE="ricos-hashtag",exports.RICOS_HEADERS_MARKDOWN_TYPE="ricos-headers-markdown",exports.RICOS_HEADING="ricos-heading",exports.RICOS_HEADINGS_DROPDOWN_TYPE="ricos-heading-dropdown",exports.RICOS_HTML_TYPE="ricos-html",exports.RICOS_IMAGE_TYPE="ricos-image",exports.RICOS_INDENT_TYPE="ricos-indent",exports.RICOS_ITALIC_TYPE="ricos-italic",exports.RICOS_LINE_SPACING_TYPE="ricos-line-spacing",exports.RICOS_LINK_BUTTON_TYPE="ricos-link-button",exports.RICOS_LINK_PREVIEW_TYPE="ricos-link-preview",exports.RICOS_LINK_TYPE="ricos-link",exports.RICOS_MAP_TYPE="ricos-map",exports.RICOS_MENTION_TYPE="ricos-mention",exports.RICOS_NODE_TYPE_TO_DATA_FIELD=RICOS_NODE_TYPE_TO_DATA_FIELD,exports.RICOS_POLL_TYPE="ricos-poll",exports.RICOS_SOUND_CLOUD_TYPE="ricos-sound-cloud",exports.RICOS_SPOILER_TYPE="ricos-spoiler",exports.RICOS_TABLE_TYPE="ricos-table",exports.RICOS_TEXT_COLOR_TYPE="ricos-text-color",exports.RICOS_TEXT_HIGHLIGHT_TYPE="ricos-text-highlight",exports.RICOS_UNDO_REDO_TYPE="ricos-undo-redo",exports.RICOS_VERTICAL_EMBED_TYPE="ricos-vertical-embed",exports.RICOS_VIDEO_TYPE="ricos-video",exports.SOUND_CLOUD_TYPE="wix-draft-plugin-sound-cloud",exports.SPOILER_TYPE="wix-rich-content-plugin-spoiler",exports.TABLE_TYPE="wix-rich-content-plugin-table",exports.TEXT_COLOR_TYPE="wix-rich-content-text-color",exports.TEXT_HIGHLIGHT_TYPE="wix-rich-content-text-highlight",exports.TIPTAP_DIVIDER_TYPE="divider",exports.TIPTAP_FILE_TYPE="file",exports.TIPTAP_GALLERY_TYPE="gallery",exports.TIPTAP_GIF_TYPE="gif",exports.TIPTAP_IMAGE_TYPE="image",exports.TIPTAP_LINK_PREVIEW_TYPE="linkPreview",exports.TIPTAP_VIDEO_TYPE="video",exports.UNDO_REDO_TYPE="wix-rich-content-undo-redo",exports.UNSTYLED="unstyled",exports.UNSUPPORTED_BLOCKS_TYPE="unsupported-blocks",exports.VERTICAL_EMBED_TYPE=VERTICAL_EMBED_TYPE,exports.VIDEO_TYPE=VIDEO_TYPE,exports.VIDEO_TYPE_LEGACY="VIDEO-EMBED",exports.Version=Version,exports.WRAP="wrap",exports.a=a,exports.and=and,exports.compare=function(object,base,options){void 0===options&&(options={});var _options=options,verbose=_options.verbose,ignoredKeys=_options.ignoredKeys,allIgnoredKeys=[].concat(IGNORED_KEYS,ignoredKeys||[]),objectWithoutIgnored=omitDeep(lodash.cloneDeep(object),allIgnoredKeys),basetWithoutIgnored=omitDeep(lodash.cloneDeep(base),allIgnoredKeys);return objectWithoutIgnored.blocks&&removeEmoji(objectWithoutIgnored),basetWithoutIgnored.blocks&&removeEmoji(basetWithoutIgnored),function changes(object,base){return lodash.transform(object,(function(result,value,key){var baseValue=base[key];if(!lodash.isEqualWith(value,baseValue,comparator)){var _console$dir,currentValue=lodash.isObject(value)&&lodash.isObject(baseValue)?changes(value,baseValue):value;if(result[key]=currentValue,verbose&&(!lodash.isObject(currentValue)||0===Object.keys(currentValue).length))console.dir(((_console$dir={})[key]={from:baseValue,to:value},_console$dir),{depth:null})}}))}(objectWithoutIgnored,basetWithoutIgnored)},exports.concatApply=concatApply,exports.createContent=function(text,type){return void 0===type&&(type="unstyled"),{blocks:[{key:"d79aa",text:text,type:type,depth:0,inlineStyleRanges:[],entityRanges:[],data:{}}],entityMap:{},VERSION:version}},exports.deepLog=function(tag){return tap(function(tag){return function(data){return console.log(tag,JSON.stringify(data,null,2))}}(tag))},exports.equals=function(E){return function(lhs){return function(rhs){return E.equals(lhs,rhs)}}},exports.firstRight=function(candidate,defaultT,resolvers){var S,firstRightSemi=(S={concat:identity},{concat:function(x,y){return isLeft(y)?x:isLeft(x)?y:right(S.concat(x.right,y.right))}});return pipe(concatAll$1(firstRightSemi)(left(defaultT))(pipe(resolvers,map$1((function(r){return pipe(candidate,fromPredicate(r[0],(function(){return defaultT})),(f=r[1],function(fa){return isLeft(fa)?fa:right(f(fa.right))}));var f})))),fold(identity,identity))},exports.generateId=function(){for(var key;void 0===key||seenKeys.hasOwnProperty(key)||!isNaN(Number(key));)key=Math.floor(Math.random()*MULTIPLIER).toString(32);return seenKeys[key]=!0,key},exports.getHost=function(url){return!url||startsWithHttps(url)||function(url){return/^http:/.test(url)}(url)?new URL(url).host:new URL("http://"+url).host},exports.getMatches=function(regex){return function(str){return pipe(regex.exec(str),fromNullable)}},exports.getUrlMatches=getUrlMatches,exports.hasProtocol=function(url){return/^[a-z]+:/i.test(url)},exports.isContentStateEmpty=function(contentState){var blocks=contentState.blocks;if(0===blocks.length)return!0;if(blocks.length>1)return!1;var firstBlock=blocks[0],text=firstBlock.text,type=firstBlock.type,depth=firstBlock.depth;return""===text&&"unstyled"===type&&0===depth},exports.isDraftContent=function(content){return lodash.isArray(content.blocks)&&lodash.isObject(content.entityMap)},exports.isListType=function(type){return"ordered-list-item"===type||"unordered-list-item"===type},exports.isRichContent=function(content){return lodash.isArray(content.nodes)},exports.isValidExactUrl=function(str){return HttpUrlPattern.test(str)},exports.isValidTelUrl=function(str){return/^tel:[0-9-()+#*]+$/.test(str)},exports.isValidUrl=function(url){return url&&"#"!==url[0]&&linkify$1.test(url)},exports.log=function(tag){return tap(function(tag){return function(data){return console.log(tag,data)}}(tag))},exports.normalizeInitialState=function(content,config){void 0===config&&(config={});var _processContentState=processContentState(lodash.cloneDeep(content),config),blocks=_processContentState.blocks,entityMap=_processContentState.entityMap,documentStyle=_processContentState.documentStyle,VERSION=_processContentState.VERSION,contentState={blocks:blocks,entityMap:normalizeEntityMap(entityMap,config,content.VERSION||"0.0.0"),VERSION:VERSION,ID:content.ID||uuid.v4()};return lodash.isEmpty(documentStyle)||(contentState.documentStyle=documentStyle),contentState},exports.normalizePoll=normalizePoll,exports.normalizeUrl=function(url){return(linkify$1.match(url)||[{}])[0].url},exports.or=or,exports.startsWithHttps=startsWithHttps,exports.stringifyWithReplace=function(replacer,space){return void 0===space&&(space=2),function(a){return function(f,onThrow){try{return right(f())}catch(e){return left(onThrow(e))}}((function(){var s=JSON.stringify(a,replacer,space);if("string"!=typeof s)throw new Error("Converting unsupported structure to JSON");return s}),identity)}},exports.tap=tap;
//# sourceMappingURL=index.js.map
